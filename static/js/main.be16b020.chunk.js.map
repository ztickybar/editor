{"version":3,"sources":["services/officegraph/index.js","services/officegraph/authHelper.js","components/StorageBrowser/index.js","containers/StorageAdministration/index.js","media/BigZtransparent.png","logo.svg","contexts/editor.js","pages/StoragePage/index.js","App.js","serviceWorker.js","index.js"],"names":["json","require","_","request","module","exports","context","req","data","body","done","action","processResult","error","result","log","plain","res","Array","isArray","auth","getAccessToken","then","token","key","toLowerCase","graph","readManager","query","sourceGroupId","params","split","length","itemId","driveId","id","name","newDoc","groupId","getGroupDrive","getGroupSite","readGroupMemberShipFor","matchingGroups","folder","getGroupDocuments","host","site","list","listfilter","itemfilter","getSharePointList","getGroupRootFolders","getDriveChildren","analyseMembers","userId","invite","addcrm","addmember","copyfile","err","console","emailAddresses","cb","addresses","forEach","element1","element2","match","smtp","push","checked","results","x","address","readUser","user","emailAddress","invitationRedirectUrl","post","response","first","last","tag","msg","url","headers","JSON","stringify","parsedBody","parse","post2","get","e","items","itemList","next","item","pop","readGroupMembers","upn","userPrincipalName","index","searchText","findGroup","folderName","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","groupNickName","fromFolder","fromName","toFolder","toName","groups","group","fromItems","find","targetFolders","destFolder","parentReference","lookupFile","iterations","file","setTimeout","config","tokenEndpoint","authorization","appendTo","retrycount","errCounter","concat","value","window","Promise","resolve","reject","requestParams","grant_type","client_id","clientId","client_secret","clientSecret","resource","form","error_description","access_token","getRaw","hasError","payload","patch","scopes","replyUrl","location","protocol","hostname","port","pathname","msalConfig","redirectUri","authority","msalApplication","UserAgentApplication","a","requestObj","handleRedirectCallback","getAccount","loginRedirect","acquireTokenSilent","authResponse","accessToken","BlobServiceClient","StorageSharedKeyCredential","listContainers","connectionString","blobServiceClient","fromConnectionString","names","iter","container","listBlobs","containerName","containerClient","getContainerClient","i","listBlobsFlat","blob","getBlob","blobName","blockBlobContainer","getBlobClient","Axios","catch","StorageBrowser","props","useState","containers","setContainers","setContainer","blobs","setBlobs","setData","useEffect","saasUrl","load","style","display","map","className","onClick","height","overflow","toString","STORAGEKEY","StorageEditor","setName","setConnectionString","connectionStringErrorMessage","setConnectionStringErrorMessage","validateStorage","Dialog","hidden","onDismiss","dialogContentProps","type","DialogType","normal","title","modalProps","isBlocking","styles","main","maxWidth","dragOptions","moveMenuItemText","closeMenuItemText","menu","ContextualMenu","TextField","label","onChange","placeholder","errorMessage","DialogFooter","PrimaryButton","disabled","onSaved","text","DefaultButton","Confirm","Label","onConfirm","Explorer","minWidth","loadStorage","AuthHelper","OfficeGraph","storages","version","connections","StorageAdministrationContainer","dialog","setDialog","errors","setErrors","setItems","isDirty","setIsDirty","isLoaded","setIsLoaded","hasExtension","setHasExtension","hasSelection","setHasSelection","selectedItems","setSelectedItems","invokedItem","setInvokedItem","needRefresh","setNeedRefresh","selection","Selection","onSelectionChanged","y","z","selectionCount","getSelectedCount","getSelection","extensionName","newitems","commands","iconProps","iconName","save","MessageBar","messageBarType","MessageBarType","isMultiline","slice","dismissButtonAriaLabel","CommandBar","farItems","overflowItems","DetailsList","columns","fieldName","isResizable","setKey","layoutMode","DetailsListLayoutMode","justified","selectionPreservedOnEmptyClick","ariaLabelForSelectionColumn","ariaLabelForSelectAllCheckbox","checkButtonAriaLabel","onItemInvoked","rowNumber","confirmed","toDelete","selectedItem","newItems","EditorContext","React","createContext","StoragePage","StorageAdministration","HomePage","loadable","msalInstance","PTO365","initializeIcons","href","search","s1","s2","s3","decodeURIComponent","getSearchParametersFromHRef","App","setUser","setMe","setAccessToken","storageErrorMessage","environments","setEnvironments","currentEnvironment","setCurrentEnvironment","setStorageAccountConnectionStrings","selectedTab","setSelectedTab","me","storageAccountConnectionString","envs","store","cacheKey","subMenuProps","ariaLabel","iconOnly","Provider","Consumer","src","BigZtransparent","margin","marginLeft","width","flexGrow","fontSize","color","whiteSpace","userName","Pivot","paddingLeft","borderBottom","onLinkClick","itemKey","navigate","selectedKey","PivotItem","headerText","Dropdown","options","dropdown","xroot","Boolean","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.be16b020.chunk.js","sourcesContent":["var json = require(\"format-json\")\nvar _ = require(\"lodash\")\nvar request = require('request');\n\n//var Q = require('q');\nmodule.exports = function (context, req) {\n  var data = req.body\n  if (!data) return context.done(\"Missing a request body\")\n  if (!data.action) return context.done(\"Missing a body.action parameter\")\n\n\n  auth.getAccessToken().then(function (token) {\n\n      var key = data.action.toLowerCase()\n\n      switch (key) {\n        case 'manager':\n          graph.readManager(token, data.query, 0, processResult)\n          break;\n        case 'newdoc':\n          var params = data.query.split(\"|\")\n\n          var sourceGroupId = params.length > 0 ? params[0] : ''\n          var itemId = params.length > 1 ? params[1] : '/'\n          var driveId = params.length > 1 ? params[2] : '/'\n          var id = params.length > 1 ? params[3] : '/'\n          var name = params.length > 1 ? params[4] : '/'\n          graph.newDoc(token, sourceGroupId, itemId, driveId, id, name, processResult)\n          break;\n        case 'getgroupdrive':\n          var params = data.query.split(\"|\")\n\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupDrive(token, groupId, processResult)\n          break;\n        case 'getgroupsite':\n          var params = data.query.split(\"|\")\n\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupSite(token, groupId, processResult)\n          break;\n        case 'memberof':\n          graph.readGroupMemberShipFor(token, data.query, processResult)\n          break;\n        case 'matchinggroups':\n          graph.matchingGroups(token, data.query, processResult)\n          break;\n        case 'getgroupdocs':\n          var params = data.query.split(\"|\")\n          var groupId = params.length > 0 ? params[0] : ''\n          var folder = params.length > 1 ? params[1] : '/'\n          graph.getGroupDocuments(token, groupId, folder, processResult)\n          break;\n        case 'sharepointlist':\n          var params = data.query.split(\"|\")\n          var host = params.length > 0 ? params[0] : ''\n          var site = params.length > 1 ? params[1] : ''\n          var list = params.length > 2 ? params[2] : ''\n          var listfilter = params.length > 3 ? params[3] : ''\n          var itemfilter = params.length > 4 ? params[4] : ''\n          graph.getSharePointList(token, host, site, list, listfilter, itemfilter, processResult)\n          break;          \n        case 'getgrouprootfolders':\n          var params = data.query.split(\"|\")\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupRootFolders(token, groupId,  processResult)\n          break;\n        case 'getdrivechildren':\n          var params =  data.query.split(\"|\")\n          var driveId = params.length > 0 ? params[0] : ''\n          var itemId = params.length > 1 ? params[1] : ''\n          graph.getDriveChildren(token, driveId, itemId, processResult)\n          break;\n        case 'collaboratewith':\n          graph.analyseMembers(token, data.query, processResult)\n\n          break;\n        case 'invite':\n        var params = data.query.split(\"|\")\n        var userId = params[0]\n        var groupId = params[1]\n          graph.invite(token, userId,\"https://teams.microsoft.com/l/team/19%3a0e28628caa7745af8d1be8b1291d3fe8%40thread.skype/conversations?groupId=b4cc43ed-537d-4111-907d-a8eb4dabd7e8&tenantId=df96b8c9-51a1-40cf-b8b1-4514be8e9668\", processResult)\n\n          break;  \n        case 'addcrm':\n\n          var params = data.query.split(\"|\")\n\n\n          graph.addcrm(token, params[0],params[1],params[2],params[3], processResult)\n\n          break;  \n        case 'addmember':\n          var params = data.query.split(\"|\")\n          var userId = params[0]\n          var groupId = params[1]\n          graph.addmember(token, userId,groupId,  processResult)\n          break;  \n        case 'copyfile':\n          var params = data.query.split(\"|\")\n\n          if (params.length < 5 ){\n            processResult(\"Wrong number of parameters \")\n          }else{\n          \n            graph.copyfile(token, params[0],params[1],params[2],params[3],params[4], processResult)\n          }\n          break;\n\n        default:\n          processResult(\"Unsupported \" + key)\n\n          break;\n      }\n\n    },\n    (err) => {\n      console.log(err)\n    })\n\n\n  function processResult(error, result) {\n    if (error) {\n      context.log(json.plain(error))\n      context.res = {\n        error: error\n      };\n\n      return context.done()\n    }\n    context.log(json.plain(result))\n\n    context.res = {\n      data: Array.isArray(result) ? result : [result] // always return an array\n    };\n    return context.done()\n\n  }\n};\n\nvar graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n\n\n  var addresses = []\n\n  var ar1 = emailAddresses.split(\"\\n\")\n  ar1.forEach(element1 => {\n    var ar2 = element1.split(\";\")\n    ar2.forEach(element2 => {\n\n      var smptAddresses = extractEmails(element2)\n      smptAddresses.forEach(smtp => {\n        addresses.push({\n          checked: false,\n          smtp\n        })\n      })\n\n    })\n  });\n\n  var results = []\n  var x = addresses.length\n  addresses.forEach(address => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--\n      address.user = user\n      address.err = err\n      results.push(address)\n      if (x < 1) {\n        cb(null, results)\n        address.checked = true\n      }\n    })\n  })\n\n\n\n\n}\ngraph.invite = (token, emailAddress,invitationRedirectUrl, cb) => {\n\n\n  var msg = \n  {\n    \"invitedUserEmailAddress\": emailAddress,\n    \"inviteRedirectUrl\": invitationRedirectUrl,\n    \"invitedUserDisplayName\": emailAddress,\n    \"sendInvitationMessage\": false,\n        \"invitedUserMessageInfo\": {\n            \"customizedMessageBody\": \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n            \"ccRecipients\": [\n              {\n                \"emailAddress\": {\n                  \"name\": \"Niels\",\n                  \"address\": \"niels@jumpto365.com\"\n                }\n              }\n            ]\n        }\n}\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, \n  function (err ,response) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null,response)\n    \n  })\n\n\n\n}\ngraph.addcrm = (token, emailAddress,first,last,tag, cb) => {\n\n\n  var msg = \n  {\n    \"properties\": [\n      {\n        \"property\": \"firstname\",\n        \"value\": first\n      },\n      {\n        \"property\": \"lastname\",\n        \"value\": last\n      },\n      {\n        \"property\": \"internal_categories\",\n        \"value\": tag\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ]\n  }\n\n   \n  post2(token, `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`, msg, \n  function (err ,response) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null,response)\n    \n  })\n\n\n\n}\ngraph.addmember = (token, userId,groupId, cb) => {\n\n\n  var msg = \n  {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`\n  }\n  post(token, `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`, msg, \n  function (err,response ) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null)\n    \n  })\n\n\n\n}\n\ngraph.getSharePointList = (token, host, site, list, listfilter, itemfilter, cb) => {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`, function (e, items) {\n  if (e) return cb(e)\n    var itemList = []\n\n    function next() {\n      if (items.length === 0) return cb(null, itemList)\n      var item = items.pop()\n      \n      get(token, `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`, function (e, item) {\n        if (e) return cb(e)\n        itemList.push(item)\n        next()\n      })\n    }\n\n    next()\n\n  })\n}\n\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(token, 'https://graph.microsoft.com/beta/groups/' + groupId + '/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id', cb)\n};\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + upn + '/memberOf', cb)\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + userPrincipalName + '/manager', cb, null, index)\n}\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + userPrincipalName, cb, null, index)\n}\n\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`, cb)\n}\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`, cb)\n}\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`, cb)\n}\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb)\n}\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`, cb)\n}\n\ngraph.getDriveChildren = function (token, driveId,itemId, cb) {\n  get(token, `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`, cb)\n}\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`, cb)\n}\n\ngraph.getSharePointSiteByName = function (token, hostName,relativePath, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`, cb)\n}\n\ngraph.getSharePointSiteDrive = function (token, id,path, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`, cb)\n}\n\n\ngraph.copyfile = function(token,groupNickName,fromFolder,fromName, toFolder,toName,cb){\n\ngraph.findGroup(token,groupNickName,function (err,groups){\n    if (err) return cb(err)\n    if (groups.length!==1) return cb(\"Did't find a unique group\")\n    var group = groups[0]\n    graph.getGroupDocuments(token,group.id,\"/\" + fromFolder,function (err,fromItems){\n      if (err) return cb(err)\n      var match = _.find(fromItems,{\"name\":fromName})\n      graph.getGroupRootFolders(token,group.id,function (err,targetFolders){\n        if (err) return cb(err)\n        var destFolder = _.find(targetFolders,{\"name\":toFolder})\n        if (!destFolder) return cb(\"Did't find target folder\")\n        graph.newDoc(token,group.id,match.id,destFolder.parentReference.driveId,  destFolder.id,toName,function (err,result){\n          if (err) return cb(err)\n          return cb(null,result)\n        })\n      })\n     })\n       \n    })\n\n\n}\n\n\nfunction lookupFile(token,driveId,id,name,iterations,cb){\n    // Content have been copied \n    graph.getDriveChildren(token,driveId,id,function (err,result){\n      if (err){\n        return cb(err)\n      }\n      // content of destination folder \n\n\n    for (let index = 0; index < result.length; index++) {\n\n      const file = result[index];\n\n      console.log(\"Comparing\",file.name,name)\n      if (file.name === name){\n        // match found  \n        console.log(\"Match found\")\n        return cb(null,file)\n      }\n    }\n\n        \n    function retry(){\n      console.log(\"Retrying\",iterations)\n      //\n      if (iterations > 10){\n        return (cb(`Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `))\n      }\n      lookupFile(token,driveId,id,name,iterations+1,cb)\n      \n\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000)\n      \n    \n    })\n  }\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n\n\n  post(token, `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`, {\n    \"parentReference\": {\n      \"driveId\": driveId,\n      \"id\": id\n    },\n    \"name\": name\n  }, function (err){ // no result from that call - by design from Microsoft\n    if (err){\n      return cb(err)\n    }\n\n    // so we fill try to find a referece our self\n    lookupFile(token,driveId,id,name,0,cb)\n  })\n\n\n}\n\n\n\n\n\n\n\n\n\n\nvar auth = {};\n\n\nvar config = {\n  \n  \n  tokenEndpoint: 'https://login.microsoftonline.com/common/oauth2/token',\n};\n\n\n\nauth.getAccessToken = function () {\n  if (window){\n    throw(\"Not valid client side\")\n  }\n  return new Promise((resolve, reject) => {\n\n    var requestParams = {\n      grant_type: 'client_credentials',\n      client_id: config.clientId,\n      client_secret: config.clientSecret,\n      resource: 'https://graph.microsoft.com'\n    };\n\n    request.post({\n      url: config.tokenEndpoint,\n      form: requestParams\n    }, function (err, response, body) {\n      var parsedBody = JSON.parse(body);\n\n      if (err) {\n\n        reject(err);\n      } else if (parsedBody.error) {\n        reject(parsedBody.error_description);\n      } else {\n        resolve(parsedBody.access_token);\n      }\n    });\n  })\n};\n\nfunction post2(token, url, body, cb) {\n  request.post({\n    url: url,\n    headers: {\n      'content-type': 'application/json'\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\n\nfunction post(token, url, body, cb) {\n  request.post({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\nfunction patch(token, url, body, cb) {\n  request.patch({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\n\nfunction get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true)\n  request.get({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    }\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      var errCounter = retrycount ? retrycount + 1 : 1;\n      if (errCounter > 3) {\n        return cb(err, null, index);\n      } else {\n        // retry \n        console.log(\"retry #\", errCounter)\n        return get(token, url, cb, appendTo, index, errCounter)\n      }\n    }\n\n    parsedBody = JSON.parse(body);\n    if (parsedBody.error) {\n      return cb(\n        parsedBody.error, null, index\n      );\n    }\n\n    if (parsedBody['@odata.nextLink']) {\n      var data;\n      if (!appendTo) {\n        data = parsedBody.value\n      } else {\n        data = appendTo.concat(parsedBody.value)\n      }\n\n      return get(token, parsedBody['@odata.nextLink'], cb, data, index)\n    }\n\n    if (appendTo) {\n      cb(null, appendTo.concat(parsedBody.value), index)\n    } else {\n      if (parsedBody.value) {\n        cb(null, parsedBody.value, index);\n      } else {\n        cb(null, parsedBody, index);\n      }\n    };\n  });\n};\n\nmodule.exports.getRaw = (token, url) => {\n  console.log(\"getting\", url)\n\n  return new Promise((resolve, reject) => {\n    \n  \n  request.get({\n    url: url,\n    headers: {\n      authorization: 'Bearer ' + token\n    }\n  }, function (err, response, body) {\n   \n\n    if (err) {\n        return resolve({hasError:true,error:err})\n    }\n    resolve({hasError:false,result:body})\n    \n  });\n});\n};\n\n\nmodule.exports.get = (token,url) => {\n  return new Promise((resolve, reject) => {\n    get(token,url,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.post = (token,url,payload) => {\n  return new Promise((resolve, reject) => {\n    post(token,url,payload,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.patch = (token,url,payload) => {\n  return new Promise((resolve, reject) => {\n    patch(token,url,payload,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.graph = graph\nmodule.exports.auth = auth\n","import { UserAgentApplication } from \"msal\";\r\n\r\nfunction getAccessToken (scopes) {\r\n  var replyUrl =\r\n    window.location.protocol +\r\n    \"//\" +\r\n    window.location.hostname +\r\n    (window.location.port !== 80 &&\r\n    window.location.port !== 443 &&\r\n    window.location.port !== \"\"\r\n      ? \":\" + window.location.port\r\n      : \"\") +\r\n    window.location.pathname;\r\n  console.log(\"login replyUrl\", replyUrl);\r\n  var msalConfig = {\r\n    auth: {\r\n      clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\r\n      redirectUri: replyUrl,\r\n      authority: \"https://login.microsoftonline.com/common\"\r\n    }\r\n  };\r\n  var msalApplication = new UserAgentApplication(msalConfig);\r\n\r\n  return new Promise(async (resolve, reject) => {\r\n    var requestObj = {\r\n      scopes\r\n    };\r\n\r\n    msalApplication.handleRedirectCallback((error, response) => {\r\n      // handle redirect response or error\r\n    });\r\n\r\n    if (!msalApplication.getAccount()) {\r\n      msalApplication.loginRedirect(requestObj);\r\n    }\r\n    try {\r\n      const authResponse = await msalApplication.acquireTokenSilent(\r\n        requestObj\r\n      );\r\n      resolve(authResponse.accessToken);\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n};\r\n\r\nexport default {\r\n  getAccessToken\r\n  \r\n};","import React, { Component, useState, useEffect } from \"react\";\n\nimport PropTypes from \"prop-types\";\nimport Axios from \"axios\";\n\nconst {\n  BlobServiceClient,\n  StorageSharedKeyCredential\n} = require(\"@azure/storage-blob\");\n\n// [Browsers only] A helper method used to convert a browser Blob into string.\nasync function blobToString(blob) {\n  debugger;\n  const fileReader = new FileReader();\n\n  return new Promise((resolve, reject) => {\n    fileReader.onloadend = ev => {\n      resolve(ev.target.result);\n    };\n    fileReader.onerror = reject;\n    fileReader.readAsText(blob);\n  });\n}\nfunction listContainers(connectionString) {\n  return new Promise(async (resolve, reject) => {\n    const blobServiceClient = BlobServiceClient.fromConnectionString(\n      connectionString\n    );\n    var names = [];\n\n    let i = 1;\n    let iter = await blobServiceClient.listContainers();\n    for await (const container of iter) {\n      names.push(container.name);\n      //console.log(`Container ${i++}: ${container.name}`);\n    }\n\n    return resolve(names);\n  });\n}\n\nfunction listBlobs(connectionString, containerName) {\n  return new Promise(async (resolve, reject) => {\n    const blobServiceClient = BlobServiceClient.fromConnectionString(\n      connectionString\n    );\n    var names = [];\n\n    const containerClient = blobServiceClient.getContainerClient(containerName);\n\n    let i = 1;\n    let iter = await containerClient.listBlobsFlat();\n    for await (const blob of iter) {\n      names.push(blob.name);\n      console.log(`Blob ${i++}: ${blob.name}`);\n    }\n\n    return resolve(names);\n  });\n}\nfunction getBlob(connectionString, containerName, blobName) {\n  return new Promise(async (resolve, reject) => {\n    const blobServiceClient = BlobServiceClient.fromConnectionString(\n      connectionString\n    );\n    var names = [];\n\n    const containerClient = blobServiceClient.getContainerClient(containerName);\n    var blockBlobContainer = containerClient.getBlobClient(blobName);\n    var url = blockBlobContainer.url;\n    Axios.get(url)\n      .then(response => {\n        resolve(response.data);\n      })\n      .catch(error => {\n        reject(error);\n      });\n  });\n}\n\nexport default function StorageBrowser(props) {\n  const [containers, setContainers] = useState([]);\n  const [container, setContainer] = useState(\"\");\n  const [blobs, setBlobs] = useState([]);\n  const [data, setData] = useState(null);\n  useEffect( () => {\n    //   var names = await listContainers(props.saasUrl, \"\");\n    async function load(){\n    setContainers(await listContainers(props.saasUrl));\n  }\n  load()\n  }, []);\n  return (\n    <div style={{ display: \"flex\" }}>\n    \n      <div>\n      Containers\n        {containers.map((container, key) => {\n          return (\n            <div\n              className=\"User\"\n              key={key}\n              onClick={async () => {\n                setBlobs([]);\n                setData(null);\n                setContainer(container);\n                setBlobs(await listBlobs(props.saasUrl, container));\n              }}\n            >\n              {container}\n            </div>\n          );\n        })}\n      </div>\n      \n      <div style={{ height: \"80vh\", overflow: \"auto\" }}>\n      Blobs\n        {blobs.map((blob, key) => {\n          return (\n            <div\n              className=\"User\"\n              key={key}\n              onClick={async () => {\n                setData(null);\n                var data = await getBlob(props.saasUrl, container, blob);\n                \n                setData(data.toString());\n              }}\n            >\n              {blob}\n            </div>\n          );\n        })}\n      </div>\n      <div>Data<div>{data}</div></div>\n    </div>\n  );\n}\n\nStorageBrowser.propTypes = {\n  /**\n   * Azure URL\n   */\n  saasUrl: PropTypes.string\n};\n","import React, { useState, useEffect } from \"react\";\nimport AuthHelper from \"../../services/officegraph/authHelper\";\nimport OfficeGraph from \"../../services/officegraph\";\nimport { DefaultButton, PrimaryButton, Label } from \"office-ui-fabric-react\";\nimport { MessageBar, MessageBarType } from \"office-ui-fabric-react\";\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  Selection\n} from \"office-ui-fabric-react/lib/DetailsList\";\n\nimport {\n  Dialog,\n  DialogType,\n  DialogFooter\n} from \"office-ui-fabric-react/lib/Dialog\";\n\nimport { ContextualMenu } from \"office-ui-fabric-react/lib/ContextualMenu\";\nimport { CommandBar } from \"office-ui-fabric-react/lib/CommandBar\";\nimport Axios from \"axios\";\nimport StorageBrowser from \"../../components/StorageBrowser\";\nconst STORAGEKEY = \"com.ztickybar.storage\";\nconst {\n  BlobServiceClient,\n  StorageSharedKeyCredential\n} = require(\"@azure/storage-blob\");\n\nfunction StorageEditor(props) {\n  const [name, setName] = useState(props.name);\n  const [connectionString, setConnectionString] = useState(props.connectionString);\n  const [connectionStringErrorMessage, setConnectionStringErrorMessage] = useState(\"\");\n  function validateStorage(connectionString) {\n    return new Promise(async (resolve, reject) => {\n      try {\n        \n        const blobServiceClient = BlobServiceClient.fromConnectionString(\n          connectionString\n        );\n\n        let i = 1;\n        let iter = await blobServiceClient.listContainers();\n        for await (const container of iter) {\n          //names.push(container.name);\n          //console.log(`Container ${i++}: ${container.name}`);\n        }\n\n        return resolve(true);\n        resolve(true);\n      } catch (error) {\n        console.log(\"Validating storage\", error);\n        resolve(false);\n      }\n    });\n  }\n  return (\n    <Dialog\n      hidden={false}\n      onDismiss={() => {\n        if (props.onDismiss) props.onDismiss();\n      }}\n      dialogContentProps={{\n        type: DialogType.normal,\n        title: \"Add link to storage account\"\n      }}\n      modalProps={{\n        isBlocking: true,\n        styles: { main: { maxWidth: 450 } },\n        dragOptions: {\n          moveMenuItemText: \"Move\",\n          closeMenuItemText: \"Close\",\n          menu: ContextualMenu\n        }\n      }}\n    >\n      <TextField\n        label=\"Name\"\n        value={name}\n        onChange={(e, value) => {\n          setName(value);\n        }}\n        placeholder=\"Describe the storage\"\n      />\n      <TextField\n        label=\"Azure storage connection string\"\n        value={connectionString}\n        onChange={(e, value) => {\n          setConnectionString(value);\n          setConnectionStringErrorMessage(\"\")\n        }}\n        errorMessage={connectionStringErrorMessage}\n      />\n\n      <DialogFooter>\n        <PrimaryButton\n          disabled={!name || !connectionString}\n          onClick={async () => {\n            var valid = await validateStorage(connectionString)\n            \n            if (!valid){\n                setConnectionStringErrorMessage(\"Not valid\")\n                return\n            }\n            if (props.onSaved) props.onSaved({name,connectionString});\n          }}\n          text=\"Connect\"\n        />\n        <DefaultButton\n          onClick={() => {\n            if (props.onDismiss) props.onDismiss();\n          }}\n          text=\"Cancel\"\n        />\n      </DialogFooter>\n    </Dialog>\n  );\n}\nfunction Confirm(props) {\n   \n    return (\n      <Dialog\n        hidden={false}\n        onDismiss={() => {\n          if (props.onDismiss) props.onDismiss();\n        }}\n        dialogContentProps={{\n          type: DialogType.normal,\n          title: \"Confirm\"\n        }}\n        modalProps={{\n          isBlocking: true,\n          styles: { main: { maxWidth: 450 } },\n          dragOptions: {\n            moveMenuItemText: \"Move\",\n            closeMenuItemText: \"Close\",\n            menu: ContextualMenu\n          }\n        }}\n      >\n    <Label text={props.text}/>\n\n\n  \n        <DialogFooter>\n          <PrimaryButton\n            \n            onClick={async () => {\n             \n              if (props.onConfirm) props.onConfirm(true);\n            }}\n            text=\"Yes\"\n          />\n          <DefaultButton\n            onClick={() => {\n                if (props.onConfirm) props.onConfirm(false);\n            }}\n            text=\"No\"\n          />\n        </DialogFooter>\n      </Dialog>\n    );\n  }\n  function Explorer(props) {\n   \n    return (\n      <Dialog\n      minWidth=\"80vw\"\n        hidden={false}\n        onDismiss={() => {\n          if (props.onDismiss) props.onDismiss();\n        }}\n        dialogContentProps={{\n          type: DialogType.normal,\n          title: \"Explore\"\n        }}\n        modalProps={{\n          isBlocking: true,\n          styles: { main: { maxWidth: 450 } },\n          dragOptions: {\n            moveMenuItemText: \"Move\",\n            closeMenuItemText: \"Close\",\n            menu: ContextualMenu\n          }\n        }}\n      >\n<StorageBrowser saasUrl={props.connectionString} />\n\n\n  \n        <DialogFooter>\n         \n          <DefaultButton\n            onClick={() => {\n                if (props.onDismiss) props.onDismiss();\n            }}\n            text=\"Close\"\n          />\n        </DialogFooter>\n      </Dialog>\n    );\n  }\n\n  export function loadStorage(){\n      return new Promise(async (resolve, reject) => {\n          \n      \n      try {\n          \n      \n    var token = await AuthHelper.getAccessToken([\"User.Read.All\"]);\n  \n    var storages = await OfficeGraph.get(\n      token,\n      `https://graph.microsoft.com/v1.0/me/extensions/${STORAGEKEY}`\n    );\n\n    switch (storages.version) {\n      case 1:\n          var key = 0;\n          var items = storages.connections.map(item => {\n              key++\n            return { key, name: item.name, value: item.value };\n          });\n        resolve(items);\n        break;\n\n      default:\n        var key = 0;\n        var items = storages.connections.map(item => {\n            key++\n          return { key, name: item.title, value: item.connectionString };\n        });\n        resolve(items);\n        break;\n    }\n} catch (error) {\n          resolve(null)\n}\n});\n  }\nfunction StorageAdministrationContainer(props) {\n  const [storages, setStorages] = useState({});\n\n  const [dialog, setDialog] = useState(\"\");\n  const [errors, setErrors] = useState([]);\n  const [items, setItems] = useState([]);\n  const [isDirty,setIsDirty]= useState(false);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [hasExtension, setHasExtension] = useState(false);\n  const [hasSelection, setHasSelection] = useState(0);\n  const [selectedItems, setSelectedItems] = useState([]);\n  const [invokedItem,setInvokedItem] = useState(null);\n  const [needRefresh, setNeedRefresh] = useState(0);\n  const [selectionDetails, setSelectionDetails] = useState(null);\n\n\n\n  const selection = new Selection({\n    onSelectionChanged: (x,y,z) => {\n      const selectionCount = selection.getSelectedCount();\n      setSelectedItems(selection.getSelection())\n      switch (selectionCount) {\n        case 0:\n          setHasSelection(selectionCount);\n      \n          return \"No items selected\";\n\n        case 1:\n          setHasSelection(selectionCount);\n           \n\n          return \"1 item selected: \" + selection.getSelection()[0].name;\n        default:\n          setHasSelection(selectionCount);\n\n          return `${selectionCount} items selected`;\n      }\n    }\n  });\n  const columns = [\n    {\n      key: \"column1\",\n      name: \"Name\",\n      fieldName: \"name\",\n      minWidth: 100,\n      maxWidth: 200,\n      isResizable: true\n    },\n    {\n      key: \"column2\",\n      name: \"Value\",\n      fieldName: \"value\",\n      minWidth: 100,\n      maxWidth: 200,\n      isResizable: true\n    }\n  ];\n\n  var farItems = [\n    // {\n    //   key: \"info\",\n    //   text: \"Info\",\n    //   // This needs an ariaLabel since it's icon-only\n    //   ariaLabel: \"Info\",\n    //   iconOnly: true,\n    //   disabled: false,\n    //   iconProps: { iconName: \"Info\" },\n    //   onClick: () => console.log(\"Info\")\n    // }\n  ];\n  var overflowItems = [\n    // {\n    //   disabled: true,\n    //   key: \"move\",\n    //   text: \"Move to...\",\n    //   onClick: () => console.log(\"Move to\"),\n    //   iconProps: { iconName: \"MoveToFolder\" }\n    // }\n  ];\n  async function save() {\n    try {\n      var data = {\n        \"@odata.type\": \"microsoft.graph.openTypeExtension\",\n        extensionName: STORAGEKEY,\n        connections: items,\n        version: 1\n      };\n   \n      var accessToken = await AuthHelper.getAccessToken([\"User.Read.All\"]);\n      if (hasExtension) {\n        var result = await OfficeGraph.patch(\n          accessToken,\n          `https://graph.microsoft.com/v1.0/me/extensions/${STORAGEKEY}`,\n          data\n        );\n      } else {\n        var result = await OfficeGraph.post(\n          accessToken,\n          \"https://graph.microsoft.com/v1.0/me/extensions/\",\n          data\n        );\n        setHasExtension(true);\n      }\n    } catch (error) {\n      errors.push({\n        context: \" OfficeGraph.auth.getAccessToken()\",\n        error\n      });\n      setErrors(errors);\n      setNeedRefresh(needRefresh + 1);\n    }\n  }\n  async function load() {\n \n      if (isLoaded) return;\n\n      var newitems = await loadStorage()\n\n  \n      setItems(newitems ? newitems: [])\n      setIsLoaded(true);\n      setHasExtension(newitems !== null);\n    \n  }\n  useEffect(() => {\n    load();\n  }, [needRefresh, hasSelection]);\n  var commands = [\n    {\n      key: \"save\",\n      text: \"Save\",\n      disabled: !isDirty,\n      iconProps: { iconName: \"Save\" },\n      onClick: () => {\n          setIsDirty(false)\n        save();\n      }\n    },\n    {\n      key: \"add\",\n      text: \"Add\",\n      disabled: false,\n      iconProps: { iconName: \"AddLink\" },\n      onClick: () => {\n        setDialog(\"add\");\n        // setNeedRefresh(needRefresh + 1);\n        // items.push({ name: \"Name\", value: \"Value\" });\n        // setItems(items);\n        // setNeedRefresh(needRefresh + 1);\n      }\n    },\n    {\n        key: \"view\",\n        text: \"View\",\n        disabled: hasSelection!==1,\n        iconProps: { iconName: \"View\" },\n        onClick: () => {\n          setDialog(\"view\");\n          // setNeedRefresh(needRefresh + 1);\n          // items.push({ name: \"Name\", value: \"Value\" });\n          // setItems(items);\n          // setNeedRefresh(needRefresh + 1);\n        }\n      },\n    {\n      key: \"delete\",\n      text: \"Delete\",\n      disabled: hasSelection===0,\n      iconProps: { iconName: \"RemoveLink\" },\n      onClick: () => {\n          setDialog(\"confirmDelete\")\n          console.log(\"Deleting\")\n        \n        }\n    },\n    // {\n    //   key: \"verify\",\n    //   text: \"Verify\",\n    //   disabled: hasSelection===0,\n    //   iconProps: { iconName: \"AccessibiltyChecker\" },\n    //   onClick: () => console.log(\"Verifying\")\n    // }\n  ];\n  return (\n    <div>\n      {errors.length > 0 && (\n        <MessageBar\n          messageBarType={MessageBarType.error}\n          isMultiline={true}\n          onDismiss={() => {\n            setErrors(errors.slice(1));\n          }}\n          dismissButtonAriaLabel=\"Close\"\n        >\n          Error: {JSON.stringify(errors[0])}\n        </MessageBar>\n      )}\n      <CommandBar\n        items={commands}\n        farItems={farItems}\n        overflowItems={overflowItems}\n      />\n      <DetailsList\n        items={items}\n        columns={columns}\n        setKey=\"set\"\n        layoutMode={DetailsListLayoutMode.justified}\n        selection={selection}\n        selectionPreservedOnEmptyClick={true}\n        ariaLabelForSelectionColumn=\"Toggle selection\"\n        ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n        checkButtonAriaLabel=\"Row checkbox\"\n        onItemInvoked={(item, rowNumber, e) => {\n            setInvokedItem(item)\n            setDialog(\"edit\")\n          console.log(\"Invoked\", item, rowNumber);\n        }}\n      />\n\n      {dialog == \"add\" && (\n        <StorageEditor\n          onDismiss={() => {\n            setDialog(\"\");\n          }}\n          onSaved={(data) => {\n            items.push({ name: data.name, value: data.connectionString });\n            setItems(items);\n            setNeedRefresh(needRefresh + 1);\n            setDialog(\"\");\n            setIsDirty(true)\n          }}\n        />\n      )}\n      {dialog == \"edit\" && (\n        <StorageEditor\n        connectionString = {invokedItem.value}\n        name = {invokedItem.name}\n          onDismiss={() => {\n            setDialog(\"\");\n          }}\n          onSaved={(data) => {\n            var i = items.map(item=>{\n                if (item.key===invokedItem.key){\n                    item.name = data.name\n                    item.value =  data.connectionString\n                }\n                return item\n            })\n           \n            setItems(i);\n            setIsDirty(true)\n           // setNeedRefresh(needRefresh + 1);\n            setDialog(\"\");\n          }}\n        />\n      )}\n            {dialog == \"view\" && (\n        <Explorer\n        connectionString = {selectedItems[0].value}\n        \n          onDismiss={() => {\n              \n            setDialog(\"\");\n          }}\n          \n        />\n      )}\n      {dialog == \"confirmDelete\" && (\n        <Confirm\n        text=\"Delete ?\" \n          onDismiss={() => {\n            setDialog(\"\");\n          }}\n          onConfirm={(confirmed) => {\n              if (confirmed){\n                  var toDelete = {}\n\n                selectedItems.forEach(selectedItem => {\n                    toDelete[selectedItem.key] = true\n                });\n                \n                var newItems = []\n                items.forEach(item => {\n                    if (!toDelete[item.key]){\n                        newItems.push(item)\n                    }\n                });\n                setSelectedItems([])\n                setItems(newItems)\n                \n              }\n              setIsDirty(true)\n            setDialog(\"\");\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default StorageAdministrationContainer;\n","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","\nimport React from \"react\";\n\nexport const EditorContext = React.createContext({ });\n\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport StorageAdministrationContainer from '../../containers/StorageAdministration'\n\nexport default function StoragePage() {\n  return (\n    <>\n    <StorageAdministrationContainer />\n    </>\n  );\n}\n\nStoragePage.propTypes = {\n\n}\n","import React, { useState, useEffect, useReducer } from \"react\";\nimport loadable from \"@loadable/component\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport { EditorContext } from \"./contexts/editor\";\nimport { Router, Match, Location, navigate } from \"@reach/router\";\n\nimport { UserAgentApplication } from \"msal\";\nimport { Label, ILabelStyles } from \"office-ui-fabric-react/lib/Label\";\nimport { Pivot, PivotItem } from \"office-ui-fabric-react/lib/Pivot\";\nimport {\n  CommandBar,\n  ICommandBarItemProps\n} from \"office-ui-fabric-react/lib/CommandBar\";\nimport { initializeIcons } from \"@uifabric/icons\";\nimport BigZtransparent from \"./media/BigZtransparent.png\";\nimport AuthHelper from \"./services/officegraph/authHelper\";\nimport OfficeGraph from \"./services/officegraph\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps\n} from \"office-ui-fabric-react\";\nimport { Dropdown } from \"office-ui-fabric-react/lib/Dropdown\";\n//\nimport StoragePage from \"./pages/StoragePage\";\nimport { loadStorage } from \"./containers/StorageAdministration\";\n\nconst HomePage = loadable(() => import(\"./pages/HomePage\"));\nconst StorageAdministrationContainer = loadable(() =>\n  import(\"./containers/StorageAdministration\")\n);\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\nfunction auth() {\n  return new Promise((resolve, reject) => {\n    try {\n      var replyUrl =\n        window.location.protocol +\n        \"//\" +\n        window.location.hostname +\n        (window.location.port !== 80 &&\n        window.location.port !== 443 &&\n        window.location.port !== \"\"\n          ? \":\" + window.location.port\n          : \"\") +\n        window.location.pathname;\n\n      var msalConfig = {\n        auth: {\n          clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n          redirectUri: replyUrl\n        }\n      };\n      var requestObj = {\n        scopes: [\"user.read\"]\n      };\n      var msalInstance = new UserAgentApplication(msalConfig);\n      msalInstance.handleRedirectCallback((error, response) => {\n        // handle redirect response or error\n      });\n      var PTO365 = {\n        user: msalInstance.getAccount()\n      };\n      if (!PTO365.user) {\n        msalInstance.loginRedirect(requestObj);\n      }\n\n      resolve(PTO365.user);\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n/**********************************************************************************************************\n * BOOT\n **********************************************************************************************************/\n\ninitializeIcons();\nconst search = getSearchParametersFromHRef(window.location.href);\n\nfunction App(props) {\n  const [context, setContext] = useState({});\n  const [user, setUser] = useState({});\n  const [me, setMe] = useState({});\n  const [accessToken, setAccessToken] = useState(\"\");\n  const [storageErrorMessage, setStorageErrorMessage] = useState(\"\");\n  const [environments, setEnvironments] = useState([]);\n  const [currentEnvironment, setCurrentEnvironment] = useState({});\n  const [\n    storageAccountConnectionStrings,\n    setStorageAccountConnectionStrings\n  ] = useState({});\n  //TODO: Set selectedTab on load depend on route\n  const [selectedTab, setSelectedTab] = useState(\"home\");\n  const [errors, setErrors] = useState([]);\n  // https://www.robinwieruch.de/react-hooks-fetch-data\n\n  async function load() {\n    auth()\n      .then(async user => {\n        setUser(user);\n        if (me) return;\n        try {\n          var token = await AuthHelper.getAccessToken([\"User.Read.All\"]);\n          setAccessToken(token);\n          var me = await OfficeGraph.get(\n            token,\n            \"https://graph.microsoft.com/v1.0/me\"\n          );\n          setMe(me);\n          var storages = await loadStorage();\n          if (storages) {\n            var storageAccountConnectionString = {};\n            var envs = storages.map((store, key) => {\n              storageAccountConnectionString[key] = store.value;\n              return { key, text: store.name };\n            });\n            setEnvironments(envs);\n            setStorageAccountConnectionStrings(storageAccountConnectionString);\n            if (envs.length > 0) {\n              setCurrentEnvironment(envs[0]);\n            }\n          }\n        } catch (error) {\n          errors.push({\n            context: \" OfficeGraph.auth.getAccessToken()\",\n            error\n          });\n          setErrors(errors);\n        }\n\n        // OfficeGraph.me().then(me=>{\n        //   debugger\n        // })\n        // .catch(error => {\n        //   errors.push({ context: \" OfficeGraph.me() \", error });\n        //   setErrors(errors);\n        // });\n      })\n      .catch(error => {\n        errors.push({ context: \"useEffect().auth() \", error });\n        setErrors(errors);\n      });\n  }\n  useEffect(() => {\n    load();\n  }, []);\n  var items = [\n    {\n      key: \"newItem\",\n      text: \"New\",\n      cacheKey: \"myCacheKey\", // changing this key will invalidate this item's cache\n      iconProps: { iconName: \"Add\" },\n      subMenuProps: {\n        items: [\n          {\n            key: \"emailMessage\",\n            text: \"Email message\",\n            disabled: true,\n            iconProps: { iconName: \"Mail\" },\n            [\"data-automation-id\"]: \"newEmailButton\" // optional\n          },\n          {\n            key: \"calendarEvent\",\n            text: \"Calendar event\",\n            disabled: true,\n            iconProps: { iconName: \"Calendar\" }\n          }\n        ]\n      }\n    },\n    {\n      key: \"upload\",\n      text: \"Upload\",\n      disabled: true,\n      iconProps: { iconName: \"Upload\" },\n      href: \"https://dev.office.com/fabric\"\n    },\n    {\n      key: \"share\",\n      text: \"Share\",\n      disabled: true,\n      iconProps: { iconName: \"Share\" },\n      onClick: () => console.log(\"Share\")\n    },\n    {\n      key: \"download\",\n      text: \"Download\",\n      disabled: true,\n      iconProps: { iconName: \"Download\" },\n      onClick: () => console.log(\"Download\")\n    }\n  ];\n  var farItems = [\n    {\n      key: \"tile\",\n      text: \"Grid view\",\n      // This needs an ariaLabel since it's icon-only\n      ariaLabel: \"Grid view\",\n      iconOnly: true,\n      disabled: true,\n      iconProps: { iconName: \"Tiles\" },\n      onClick: () => console.log(\"Tiles\")\n    },\n    {\n      key: \"info\",\n      text: \"Info\",\n      // This needs an ariaLabel since it's icon-only\n      ariaLabel: \"Info\",\n      iconOnly: true,\n      iconProps: { iconName: \"Info\" },\n      onClick: () => console.log(\"Info\")\n    }\n  ];\n  var overflowItems = [\n    {\n      disabled: true,\n      key: \"move\",\n      text: \"Move to...\",\n      onClick: () => console.log(\"Move to\"),\n      iconProps: { iconName: \"MoveToFolder\" }\n    },\n    {\n      disabled: true,\n      key: \"copy\",\n      text: \"Copy to...\",\n      onClick: () => console.log(\"Copy to\"),\n      iconProps: { iconName: \"Copy\" }\n    },\n    {\n      disabled: true,\n      key: \"rename\",\n      text: \"Rename...\",\n      onClick: () => console.log(\"Rename\"),\n      iconProps: { iconName: \"Edit\" }\n    }\n  ];\n  return (\n    <div>\n      <EditorContext.Provider value={context}>\n        <EditorContext.Consumer>\n          {props => {\n            return <></>;\n          }}\n        </EditorContext.Consumer>\n        <Location>\n          {({ location }) => {\n            switch (location.pathname) {\n              case \"/storage\":\n                if (selectedTab !== \"storage\") setSelectedTab(\"storage\");\n                break;\n\n              case \"/edit\":\n                if (selectedTab !== \"edit\") setSelectedTab(\"edit\");\n                break;\n              case \"/tiles\":\n                if (selectedTab !== \"tiles\") setSelectedTab(\"tiles\");\n                break;\n              case \"/bars\":\n                if (selectedTab !== \"bars\") setSelectedTab(\"bars\");\n                break;\n              case \"/\":\n                if (selectedTab !== \"home\") setSelectedTab(\"home\");\n                break;\n\n              default:\n                break;\n            }\n            // ...\n            return (\n              <div>\n                <div className=\"topBar\">\n                  <div style={{ display: \"flex\" }}>\n                    <div>\n                      {\" \"}\n                      <img\n                        src={BigZtransparent}\n                        style={{\n                          margin: \"8px\",\n                          marginLeft: \"16px\",\n                          height: \"32px\",\n                          width: \"auto\"\n                        }}\n                      ></img>\n                    </div>\n                    <div\n                      style={{\n                        flexGrow: 1,\n                        margin: \"10px\",\n                        fontSize: \"24px\",\n                        color: \"#cccccc\",\n                        whiteSpace: \"nowrap\",\n                        overflow: \"hidden\"\n                      }}\n                    >\n                      ZTICKYBAR STUDIO\n                    </div>\n                    <div\n                      style={{\n                        margin: \"16px\",\n                        fontSize: \"12px\",\n                        color: \"#cccccc\",\n                        whiteSpace: \"nowrap\",\n                        overflow: \"hidden\"\n                      }}\n                    >\n                      {user.name} ({user.userName})\n                    </div>\n                  </div>\n                </div>\n\n                {errors.length > 0 && (\n                  <MessageBar\n                    messageBarType={MessageBarType.error}\n                    isMultiline={false}\n                    onDismiss={() => {\n                      setErrors(errors.slice(1));\n                    }}\n                    dismissButtonAriaLabel=\"Close\"\n                  >\n                    Error: {JSON.stringify(errors[0])}\n                  </MessageBar>\n                )}\n                <div>\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ flexGrow: 1 }}>\n                      {\" \"}\n                      <Pivot\n                        style={{\n                          paddingLeft: 20,\n                          borderBottom: \"1px solid #eeeeee\"\n                        }}\n                        onLinkClick={item => {\n                          setSelectedTab(item.props.itemKey);\n                          switch (item.props.itemKey) {\n                            case \"storage\":\n                              navigate(\"/storage\");\n                              break;\n                            case \"home\":\n                              navigate(\"/\");\n                              break;\n                            case \"edit\":\n                              navigate(\"/edit\");\n                              break;\n                            case \"bars\":\n                              navigate(\"/bars\");\n                              break;\n                            case \"tiles\":\n                              navigate(\"/tiles\");\n                              break;\n                            default:\n                              break;\n                          }\n                        }}\n                        selectedKey={selectedTab}\n                      >\n                        <PivotItem headerText=\"Dashboard\" itemKey=\"home\" />\n                        <PivotItem headerText=\"Bars\" itemKey=\"bars\" />\n                        <PivotItem headerText=\"Tiles\" itemKey=\"tiles\" />\n\n                        <PivotItem headerText=\"Storage\" itemKey=\"storage\" />\n                      </Pivot>\n                    </div>\n                    <div style={{ margin: \"8px\" }}>\n                    <Dropdown\n                        placeholder=\"Select an environment\"\n                        selectedKey={currentEnvironment.key}\n                        options={environments}\n                        errorMessage={storageErrorMessage}\n                        styles={{\n                          dropdown: { width: 200 },\n                          xroot: { height: 100 }\n                        }}\n                      />\n                    </div>\n                  </div>\n                </div>\n                <div>\n                  {selectedTab === \"edit\" && (\n                    <CommandBar\n                      items={items}\n                      farItems={farItems}\n                      overflowItems={overflowItems}\n                    />\n                  )}\n                  {selectedTab === \"settings\" && (\n                    <>\n                      <StorageAdministrationContainer />\n                    </>\n                  )}\n                </div>\n              </div>\n            );\n          }}\n        </Location>\n        <div></div>\n        <Router>\n          <HomePage path=\"/\" />\n          <StoragePage path=\"/storage\" />\n        </Router>\n      </EditorContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}