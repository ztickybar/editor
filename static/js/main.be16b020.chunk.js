(this["webpackJsonpapp-v4-editor"]=this["webpackJsonpapp-v4-editor"]||[]).push([[0],{105:function(e,t,n){var r=n(347),a=n(348),o=n(349);e.exports=function(e,t){var n=t.body;if(!n)return e.done("Missing a request body");if(!n.action)return e.done("Missing a body.action parameter");function a(t,n){return t?(e.log(r.plain(t)),e.res={error:t},e.done()):(e.log(r.plain(n)),e.res={data:Array.isArray(n)?n:[n]},e.done())}i.getAccessToken().then((function(e){var t=n.action.toLowerCase();switch(t){case"manager":c.readManager(e,n.query,0,a);break;case"newdoc":var r=(b=n.query.split("|")).length>0?b[0]:"",o=b.length>1?b[1]:"/",i=b.length>1?b[2]:"/",A=b.length>1?b[3]:"/",s=b.length>1?b[4]:"/";c.newDoc(e,r,o,i,A,s,a);break;case"getgroupdrive":var u=(b=n.query.split("|")).length>0?b[0]:"";c.getGroupDrive(e,u,a);break;case"getgroupsite":u=(b=n.query.split("|")).length>0?b[0]:"";c.getGroupSite(e,u,a);break;case"memberof":c.readGroupMemberShipFor(e,n.query,a);break;case"matchinggroups":c.matchingGroups(e,n.query,a);break;case"getgroupdocs":u=(b=n.query.split("|")).length>0?b[0]:"";var l=b.length>1?b[1]:"/";c.getGroupDocuments(e,u,l,a);break;case"sharepointlist":var f=(b=n.query.split("|")).length>0?b[0]:"",m=b.length>1?b[1]:"",p=b.length>2?b[2]:"",d=b.length>3?b[3]:"",g=b.length>4?b[4]:"";c.getSharePointList(e,f,m,p,d,g,a);break;case"getgrouprootfolders":u=(b=n.query.split("|")).length>0?b[0]:"";c.getGroupRootFolders(e,u,a);break;case"getdrivechildren":i=(b=n.query.split("|")).length>0?b[0]:"",o=b.length>1?b[1]:"";c.getDriveChildren(e,i,o,a);break;case"collaboratewith":c.analyseMembers(e,n.query,a);break;case"invite":var v=(b=n.query.split("|"))[0];u=b[1];c.invite(e,v,"https://teams.microsoft.com/l/team/19%3a0e28628caa7745af8d1be8b1291d3fe8%40thread.skype/conversations?groupId=b4cc43ed-537d-4111-907d-a8eb4dabd7e8&tenantId=df96b8c9-51a1-40cf-b8b1-4514be8e9668",a);break;case"addcrm":var b=n.query.split("|");c.addcrm(e,b[0],b[1],b[2],b[3],a);break;case"addmember":v=(b=n.query.split("|"))[0],u=b[1];c.addmember(e,v,u,a);break;case"copyfile":(b=n.query.split("|")).length<5?a("Wrong number of parameters "):c.copyfile(e,b[0],b[1],b[2],b[3],b[4],a);break;default:a("Unsupported "+t)}}),(function(e){console.log(e)}))};var c={};c.analyseMembers=function(e,t,n){var r=[];t.split("\n").forEach((function(e){e.split(";").forEach((function(e){e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi).forEach((function(e){r.push({checked:!1,smtp:e})}))}))}));var a=[],o=r.length;r.forEach((function(t){c.readUser(e,t.smtp,0,(function(e,r){o--,t.user=r,t.err=e,a.push(t),o<1&&(n(null,a),t.checked=!0)}))}))},c.invite=function(e,t,n,r){s(e,"https://graph.microsoft.com/v1.0/invitations",{invitedUserEmailAddress:t,inviteRedirectUrl:n,invitedUserDisplayName:t,sendInvitationMessage:!1,invitedUserMessageInfo:{customizedMessageBody:"We are really happy to invite you to the JUMPTO365 #Insider program ",ccRecipients:[{emailAddress:{name:"Niels",address:"niels@jumpto365.com"}}]}},(function(e,t){if(e)return r(e);r(null,t)}))},c.addcrm=function(e,t,n,r,a,c){var i={properties:[{property:"firstname",value:n},{property:"lastname",value:r},{property:"internal_categories",value:a}]};!function(e,t,n,r){o.post({url:t,headers:{"content-type":"application/json"},body:JSON.stringify(n)},(function(e,t,n){var a;return e?r(e):(a=""===n?{}:JSON.parse(n)).error?r(a.error):void r(null,a)}))}(0,"https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/".concat(t,"/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2"),i,(function(e,t){if(e)return c(e);c(null,t)}))},c.addmember=function(e,t,n,r){var a={"@odata.id":"https://graph.microsoft.com/beta/directoryObjects/".concat(t)};s(e,"https://graph.microsoft.com/beta/groups/".concat(n,"/members/$ref"),a,(function(e,t){if(e)return r(e);r(null)}))},c.getSharePointList=function(e,t,n,r,a,o,c){u(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(r,"/items?").concat(a),(function(a,i){if(a)return c(a);var A=[];!function a(){if(0===i.length)return c(null,A);var s=i.pop();u(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(r,"/items/").concat(s.id,"?").concat(o),(function(e,t){if(e)return c(e);A.push(t),a()}))}()}))},c.readGroupMembers=function(e,t,n){u(e,"https://graph.microsoft.com/beta/groups/"+t+"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id",n)},c.readGroupMemberShipFor=function(e,t,n){u(e,"https://graph.microsoft.com/v1.0/users/"+t+"/memberOf",n)},c.readManager=function(e,t,n,r){u(e,"https://graph.microsoft.com/v1.0/users/"+t+"/manager",r,null,n)},c.readUser=function(e,t,n,r){u(e,"https://graph.microsoft.com/v1.0/users/"+t,r,null,n)},c.matchingGroups=function(e,t,n){u(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'".concat(t,"')"),n)},c.findGroup=function(e,t,n){u(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '".concat(t,"'"),n)},c.getGroupDocuments=function(e,t,n,r){u(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root:").concat(n,":/children"),r)},c.getGroupDrive=function(e,t,n){u(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive"),n)},c.getGroupSite=function(e,t,n){u(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/sites/root"),n)},c.getDriveChildren=function(e,t,n,r){u(e,"https://graph.microsoft.com/beta/drives/".concat(t,"/items/").concat(n,"/children"),r)},c.getGroupRootFolders=function(e,t,n){u(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root/children"),n)},c.getSharePointSiteByName=function(e,t,n,r){u(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),r)},c.getSharePointSiteDrive=function(e,t,n,r){u(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,"/drive/root:/").concat(n,":/children"),r)},c.copyfile=function(e,t,n,r,o,i,A){c.findGroup(e,t,(function(t,s){if(t)return A(t);if(1!==s.length)return A("Did't find a unique group");var u=s[0];c.getGroupDocuments(e,u.id,"/"+n,(function(t,n){if(t)return A(t);var s=a.find(n,{name:r});c.getGroupRootFolders(e,u.id,(function(t,n){if(t)return A(t);var r=a.find(n,{name:o});if(!r)return A("Did't find target folder");c.newDoc(e,u.id,s.id,r.parentReference.driveId,r.id,i,(function(e,t){return e?A(e):A(null,t)}))}))}))}))},c.newDoc=function(e,t,n,r,a,o,i){s(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/").concat(n,"/copy"),{parentReference:{driveId:r,id:a},name:o},(function(t){if(t)return i(t);!function e(t,n,r,a,o,i){c.getDriveChildren(t,n,r,(function(c,A){if(c)return i(c);for(var s=0;s<A.length;s++){var u=A[s];if(console.log("Comparing",u.name,a),u.name===a)return console.log("Match found"),i(null,u)}setTimeout((function(){if(console.log("Retrying",o),o>10)return i("Think that the file has been created, but could not find a reference to if. Filename is ".concat(a," - Tryed ").concat(o," to find it "));e(t,n,r,a,o+1,i)}),1e3)}))}(e,r,a,o,0,i)}))};var i={},A={tokenEndpoint:"https://login.microsoftonline.com/common/oauth2/token"};function s(e,t,n,r){o.post({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var a;return e?r(e):(a=""===n?{}:JSON.parse(n)).error?r(a.error):void r(null,a)}))}function u(e,t,n,r,a,c){console.log("getting",t,!0===r),o.get({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e}},(function(o,i,A){var s,l;if(o){var f=c?c+1:1;return f>3?n(o,null,a):(console.log("retry #",f),u(e,t,n,r,a,f))}return(s=JSON.parse(A)).error?n(s.error,null,a):s["@odata.nextLink"]?(l=r?r.concat(s.value):s.value,u(e,s["@odata.nextLink"],n,l,a)):void(r?n(null,r.concat(s.value),a):s.value?n(null,s.value,a):n(null,s,a))}))}i.getAccessToken=function(){if(window)throw"Not valid client side";return new Promise((function(e,t){var n={grant_type:"client_credentials",client_id:A.clientId,client_secret:A.clientSecret,resource:"https://graph.microsoft.com"};o.post({url:A.tokenEndpoint,form:n},(function(n,r,a){var o=JSON.parse(a);n?t(n):o.error?t(o.error_description):e(o.access_token)}))}))},e.exports.getRaw=function(e,t){return console.log("getting",t),new Promise((function(n,r){o.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return n({hasError:!0,error:e});n({hasError:!1,result:r})}))}))},e.exports.get=function(e,t){return new Promise((function(n,r){u(e,t,(function(e,t){if(e)return r(e);n(t)}))}))},e.exports.post=function(e,t,n){return new Promise((function(r,a){s(e,t,n,(function(e,t){if(e)return a(e);r(t)}))}))},e.exports.patch=function(e,t,n){return new Promise((function(r,a){!function(e,t,n,r){o.patch({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var a;return e?r(e):(a=""===n?{}:JSON.parse(n)).error?r(a.error):void r(null,a)}))}(e,t,n,(function(e,t){if(e)return a(e);r(t)}))}))},e.exports.graph=c,e.exports.auth=i},127:function(e,t,n){"use strict";var r=n(16),a=n.n(r),o=n(35),c=n(159);t.a={getAccessToken:function(e){var t=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname;console.log("login replyUrl",t);var n={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:t,authority:"https://login.microsoftonline.com/common"}},r=new c.a(n);return new Promise(function(){var t=Object(o.a)(a.a.mark((function t(n,o){var c,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={scopes:e},r.handleRedirectCallback((function(e,t){})),r.getAccount()||r.loginRedirect(c),t.prev=3,t.next=6,r.acquireTokenSilent(c);case 6:i=t.sent,n(i.accessToken),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),o(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e,n){return t.apply(this,arguments)}}())}}},161:function(e,t,n){"use strict";n.r(t);var r=n(16),a=n.n(r),o=n(35),c=n(20),i=n(128),A=n(2),s=n.n(A),u=n(127),l=n(105),f=n.n(l),m=n(625),p=n(315),d=n(636),g=n(639),v=n(18),b=n(634),h=n(626),w=n(627),B=n(23),y=n(631),C=n(92),D=n(314),k=n(629),x=n(628),O=n(204),E=n.n(O),P=n(296),S=P.BlobServiceClient;P.StorageSharedKeyCredential;function Q(e){return new Promise(function(){var t=Object(o.a)(a.a.mark((function t(n,r){var o,c,A,s,u,l,f,m,p,d;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=S.fromConnectionString(e),c=[],1,t.next=5,o.listContainers();case 5:A=t.sent,s=!0,u=!1,t.prev=8,f=Object(i.a)(A);case 10:return t.next=12,f.next();case 12:return m=t.sent,s=m.done,t.next=16,m.value;case 16:if(p=t.sent,s){t.next=23;break}d=p,c.push(d.name);case 20:s=!0,t.next=10;break;case 23:t.next=29;break;case 25:t.prev=25,t.t0=t.catch(8),u=!0,l=t.t0;case 29:if(t.prev=29,t.prev=30,s||null==f.return){t.next=34;break}return t.next=34,f.return();case 34:if(t.prev=34,!u){t.next=37;break}throw l;case 37:return t.finish(34);case 38:return t.finish(29);case 39:return t.abrupt("return",n(c));case 40:case"end":return t.stop()}}),t,null,[[8,25,29,39],[30,,34,38]])})));return function(e,n){return t.apply(this,arguments)}}())}function j(e,t){return new Promise(function(){var n=Object(o.a)(a.a.mark((function n(r,o){var c,A,s,u,l,f,m,p,d,g,v,b;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=S.fromConnectionString(e),A=[],s=c.getContainerClient(t),u=1,n.next=6,s.listBlobsFlat();case 6:l=n.sent,f=!0,m=!1,n.prev=9,d=Object(i.a)(l);case 11:return n.next=13,d.next();case 13:return g=n.sent,f=g.done,n.next=17,g.value;case 17:if(v=n.sent,f){n.next=25;break}b=v,A.push(b.name),console.log("Blob ".concat(u++,": ").concat(b.name));case 22:f=!0,n.next=11;break;case 25:n.next=31;break;case 27:n.prev=27,n.t0=n.catch(9),m=!0,p=n.t0;case 31:if(n.prev=31,n.prev=32,f||null==d.return){n.next=36;break}return n.next=36,d.return();case 36:if(n.prev=36,!m){n.next=39;break}throw p;case 39:return n.finish(36);case 40:return n.finish(31);case 41:return n.abrupt("return",r(A));case 42:case"end":return n.stop()}}),n,null,[[9,27,31,41],[32,,36,40]])})));return function(e,t){return n.apply(this,arguments)}}())}function I(e,t,n){return new Promise(function(){var r=Object(o.a)(a.a.mark((function r(o,c){var i,A,s,u;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=S.fromConnectionString(e),[],A=i.getContainerClient(t),s=A.getBlobClient(n),u=s.url,E.a.get(u).then((function(e){o(e.data)})).catch((function(e){c(e)}));case 6:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}function N(e){var t=Object(A.useState)([]),n=Object(c.a)(t,2),r=n[0],i=n[1],u=Object(A.useState)(""),l=Object(c.a)(u,2),f=l[0],m=l[1],p=Object(A.useState)([]),d=Object(c.a)(p,2),g=d[0],v=d[1],b=Object(A.useState)(null),h=Object(c.a)(b,2),w=h[0],B=h[1];return Object(A.useEffect)((function(){function t(){return(t=Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i,t.next=3,Q(e.saasUrl);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),s.a.createElement("div",{style:{display:"flex"}},s.a.createElement("div",null,"Containers",r.map((function(t,n){return s.a.createElement("div",{className:"User",key:n,onClick:Object(o.a)(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return v([]),B(null),m(t),n.t0=v,n.next=6,j(e.saasUrl,t);case 6:n.t1=n.sent,(0,n.t0)(n.t1);case 8:case"end":return n.stop()}}),n)})))},t)}))),s.a.createElement("div",{style:{height:"80vh",overflow:"auto"}},"Blobs",g.map((function(t,n){return s.a.createElement("div",{className:"User",key:n,onClick:Object(o.a)(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return B(null),n.next=3,I(e.saasUrl,f,t);case 3:r=n.sent,B(r.toString());case 5:case"end":return n.stop()}}),n)})))},t)}))),s.a.createElement("div",null,"Data",s.a.createElement("div",null,w)))}n.d(t,"loadStorage",(function(){return R}));var G="com.ztickybar.storage",T=n(296),M=T.BlobServiceClient;T.StorageSharedKeyCredential;function U(e){var t=Object(A.useState)(e.name),n=Object(c.a)(t,2),r=n[0],u=n[1],l=Object(A.useState)(e.connectionString),f=Object(c.a)(l,2),d=f[0],g=f[1],v=Object(A.useState)(""),h=Object(c.a)(v,2),w=h[0],B=h[1];function x(e){return new Promise(function(){var t=Object(o.a)(a.a.mark((function t(n,r){var o,c,A,s,u,l,f,m;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=M.fromConnectionString(e),1,t.next=5,o.listContainers();case 5:c=t.sent,A=!0,s=!1,t.prev=8,l=Object(i.a)(c);case 10:return t.next=12,l.next();case 12:return f=t.sent,A=f.done,t.next=16,f.value;case 16:if(m=t.sent,A){t.next=22;break}m;case 19:A=!0,t.next=10;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(8),s=!0,u=t.t0;case 28:if(t.prev=28,t.prev=29,A||null==l.return){t.next=33;break}return t.next=33,l.return();case 33:if(t.prev=33,!s){t.next=36;break}throw u;case 36:return t.finish(33);case 37:return t.finish(28);case 38:return t.abrupt("return",n(!0));case 42:t.prev=42,t.t1=t.catch(0),console.log("Validating storage",t.t1),n(!1);case 46:case"end":return t.stop()}}),t,null,[[0,42],[8,24,28,38],[29,,33,37]])})));return function(e,n){return t.apply(this,arguments)}}())}return s.a.createElement(y.a,{hidden:!1,onDismiss:function(){e.onDismiss&&e.onDismiss()},dialogContentProps:{type:C.a.normal,title:"Add link to storage account"},modalProps:{isBlocking:!0,styles:{main:{maxWidth:450}},dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:k.a}}},s.a.createElement(b.a,{label:"Name",value:r,onChange:function(e,t){u(t)},placeholder:"Describe the storage"}),s.a.createElement(b.a,{label:"Azure storage connection string",value:d,onChange:function(e,t){g(t),B("")},errorMessage:w}),s.a.createElement(D.a,null,s.a.createElement(m.a,{disabled:!r||!d,onClick:Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x(d);case 2:if(t.sent){t.next=6;break}return B("Not valid"),t.abrupt("return");case 6:e.onSaved&&e.onSaved({name:r,connectionString:d});case 7:case"end":return t.stop()}}),t)}))),text:"Connect"}),s.a.createElement(p.a,{onClick:function(){e.onDismiss&&e.onDismiss()},text:"Cancel"})))}function z(e){return s.a.createElement(y.a,{hidden:!1,onDismiss:function(){e.onDismiss&&e.onDismiss()},dialogContentProps:{type:C.a.normal,title:"Confirm"},modalProps:{isBlocking:!0,styles:{main:{maxWidth:450}},dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:k.a}}},s.a.createElement(d.a,{text:e.text}),s.a.createElement(D.a,null,s.a.createElement(m.a,{onClick:Object(o.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.onConfirm&&e.onConfirm(!0);case 1:case"end":return t.stop()}}),t)}))),text:"Yes"}),s.a.createElement(p.a,{onClick:function(){e.onConfirm&&e.onConfirm(!1)},text:"No"})))}function W(e){return s.a.createElement(y.a,{minWidth:"80vw",hidden:!1,onDismiss:function(){e.onDismiss&&e.onDismiss()},dialogContentProps:{type:C.a.normal,title:"Explore"},modalProps:{isBlocking:!0,styles:{main:{maxWidth:450}},dragOptions:{moveMenuItemText:"Move",closeMenuItemText:"Close",menu:k.a}}},s.a.createElement(N,{saasUrl:e.connectionString}),s.a.createElement(D.a,null,s.a.createElement(p.a,{onClick:function(){e.onDismiss&&e.onDismiss()},text:"Close"})))}function R(){return new Promise(function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r,o,c,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.getAccessToken(["User.Read.All"]);case 3:return r=e.sent,e.next=6,f.a.get(r,"https://graph.microsoft.com/v1.0/me/extensions/".concat(G));case 6:o=e.sent,e.t0=o.version,e.next=1===e.t0?10:14;break;case 10:return c=0,i=o.connections.map((function(e){return{key:++c,name:e.name,value:e.value}})),t(i),e.abrupt("break",18);case 14:return c=0,i=o.connections.map((function(e){return{key:++c,name:e.title,value:e.connectionString}})),t(i),e.abrupt("break",18);case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(0),t(null);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}())}t.default=function(e){var t=Object(A.useState)({}),n=Object(c.a)(t,2),r=(n[0],n[1],Object(A.useState)("")),i=Object(c.a)(r,2),l=i[0],m=i[1],p=Object(A.useState)([]),d=Object(c.a)(p,2),b=d[0],y=d[1],C=Object(A.useState)([]),D=Object(c.a)(C,2),k=D[0],O=D[1],E=Object(A.useState)(!1),P=Object(c.a)(E,2),S=P[0],Q=P[1],j=Object(A.useState)(!1),I=Object(c.a)(j,2),N=I[0],T=I[1],M=Object(A.useState)(!1),X=Object(c.a)(M,2),H=X[0],Y=X[1],L=Object(A.useState)(0),q=Object(c.a)(L,2),K=q[0],J=q[1],F=Object(A.useState)([]),V=Object(c.a)(F,2),Z=V[0],_=V[1],$=Object(A.useState)(null),ee=Object(c.a)($,2),te=ee[0],ne=ee[1],re=Object(A.useState)(0),ae=Object(c.a)(re,2),oe=ae[0],ce=ae[1],ie=Object(A.useState)(null),Ae=Object(c.a)(ie,2),se=(Ae[0],Ae[1],new h.a({onSelectionChanged:function(e,t,n){var r=se.getSelectedCount();switch(_(se.getSelection()),r){case 0:return J(r),"No items selected";case 1:return J(r),"1 item selected: "+se.getSelection()[0].name;default:return J(r),"".concat(r," items selected")}}}));function ue(){return(ue=Object(o.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={"@odata.type":"microsoft.graph.openTypeExtension",extensionName:G,connections:k,version:1},e.next=4,u.a.getAccessToken(["User.Read.All"]);case 4:if(n=e.sent,!H){e.next=11;break}return e.next=8,f.a.patch(n,"https://graph.microsoft.com/v1.0/me/extensions/".concat(G),t);case 8:e.sent,e.next=15;break;case 11:return e.next=13,f.a.post(n,"https://graph.microsoft.com/v1.0/me/extensions/",t);case 13:e.sent,Y(!0);case 15:e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),b.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),y(b),ce(oe+1);case 22:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function le(){return(le=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,R();case 4:t=e.sent,O(t||[]),T(!0),Y(null!==t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(A.useEffect)((function(){!function(){le.apply(this,arguments)}()}),[oe,K]);var fe=[{key:"save",text:"Save",disabled:!S,iconProps:{iconName:"Save"},onClick:function(){Q(!1),function(){ue.apply(this,arguments)}()}},{key:"add",text:"Add",disabled:!1,iconProps:{iconName:"AddLink"},onClick:function(){m("add")}},{key:"view",text:"View",disabled:1!==K,iconProps:{iconName:"View"},onClick:function(){m("view")}},{key:"delete",text:"Delete",disabled:0===K,iconProps:{iconName:"RemoveLink"},onClick:function(){m("confirmDelete"),console.log("Deleting")}}];return s.a.createElement("div",null,b.length>0&&s.a.createElement(g.a,{messageBarType:v.a.error,isMultiline:!0,onDismiss:function(){y(b.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(b[0])),s.a.createElement(x.a,{items:fe,farItems:[],overflowItems:[]}),s.a.createElement(w.a,{items:k,columns:[{key:"column1",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0},{key:"column2",name:"Value",fieldName:"value",minWidth:100,maxWidth:200,isResizable:!0}],setKey:"set",layoutMode:B.e.justified,selection:se,selectionPreservedOnEmptyClick:!0,ariaLabelForSelectionColumn:"Toggle selection",ariaLabelForSelectAllCheckbox:"Toggle selection for all items",checkButtonAriaLabel:"Row checkbox",onItemInvoked:function(e,t,n){ne(e),m("edit"),console.log("Invoked",e,t)}}),"add"==l&&s.a.createElement(U,{onDismiss:function(){m("")},onSaved:function(e){k.push({name:e.name,value:e.connectionString}),O(k),ce(oe+1),m(""),Q(!0)}}),"edit"==l&&s.a.createElement(U,{connectionString:te.value,name:te.name,onDismiss:function(){m("")},onSaved:function(e){var t=k.map((function(t){return t.key===te.key&&(t.name=e.name,t.value=e.connectionString),t}));O(t),Q(!0),m("")}}),"view"==l&&s.a.createElement(W,{connectionString:Z[0].value,onDismiss:function(){m("")}}),"confirmDelete"==l&&s.a.createElement(z,{text:"Delete ?",onDismiss:function(){m("")},onConfirm:function(e){if(e){var t={};Z.forEach((function(e){t[e.key]=!0}));var n=[];k.forEach((function(e){t[e.key]||n.push(e)})),_([]),O(n)}Q(!0),m("")}}))}},205:function(e,t){},300:function(e,t){e.exports="data:image/png;base64,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"},304:function(e,t){},331:function(e,t,n){e.exports=n(577)},336:function(e,t,n){},340:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},341:function(e,t,n){},364:function(e,t){},366:function(e,t){},396:function(e,t){},397:function(e,t){},462:function(e,t){},577:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),o=n(50),c=n.n(o),i=(n(336),n(16)),A=n.n(i),s=n(297),u=n(35),l=n(20),f=n(212),m=(n(340),n(341),a.a.createContext({})),p=n(88),d=n(159),g=n(635),v=n(312),b=n(628),h=n(313),w=n(300),B=n.n(w),y=n(127),C=n(105),D=n.n(C),k=n(639),x=n(18),O=n(630),E=n(161);function P(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(E.default,null))}var S=Object(f.a)((function(){return n.e(3).then(n.bind(null,644))})),Q=Object(f.a)((function(){return Promise.resolve().then(n.bind(null,161))}));function j(){return new Promise((function(e,t){try{var n={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname}},r=new d.a(n);r.handleRedirectCallback((function(e,t){}));var a={user:r.getAccount()};a.user||r.loginRedirect({scopes:["user.read"]}),e(a.user)}catch(o){t(o)}}))}Object(h.a)();!function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var r=n[1].split("&"),a=0;a<r.length;a++){var o=r[a].split("=");t[o[0]]=decodeURIComponent(o[1])}}(window.location.href);var I=function(e){var t=Object(r.useState)({}),n=Object(l.a)(t,2),o=n[0],c=(n[1],Object(r.useState)({})),i=Object(l.a)(c,2),f=i[0],d=i[1],h=Object(r.useState)({}),w=Object(l.a)(h,2),C=(w[0],w[1]),I=Object(r.useState)(""),N=Object(l.a)(I,2),G=(N[0],N[1]),T=Object(r.useState)(""),M=Object(l.a)(T,2),U=M[0],z=(M[1],Object(r.useState)([])),W=Object(l.a)(z,2),R=W[0],X=W[1],H=Object(r.useState)({}),Y=Object(l.a)(H,2),L=Y[0],q=Y[1],K=Object(r.useState)({}),J=Object(l.a)(K,2),F=(J[0],J[1]),V=Object(r.useState)("home"),Z=Object(l.a)(V,2),_=Z[0],$=Z[1],ee=Object(r.useState)([]),te=Object(l.a)(ee,2),ne=te[0],re=te[1];function ae(){return(ae=Object(u.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j().then(function(){var e=Object(u.a)(A.a.mark((function e(t){var n,r,a,o,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d(t),!r){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,y.a.getAccessToken(["User.Read.All"]);case 6:return n=e.sent,G(n),e.next=10,D.a.get(n,"https://graph.microsoft.com/v1.0/me");case 10:return r=e.sent,C(r),e.next=14,Object(E.loadStorage)();case 14:(a=e.sent)&&(o={},c=a.map((function(e,t){return o[t]=e.value,{key:t,text:e.name}})),X(c),F(o),c.length>0&&q(c[0])),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),ne.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),re(ne);case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){ne.push({context:"useEffect().auth() ",error:e}),re(ne)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){!function(){ae.apply(this,arguments)}()}),[]);var oe=[{key:"newItem",text:"New",cacheKey:"myCacheKey",iconProps:{iconName:"Add"},subMenuProps:{items:[Object(s.a)({key:"emailMessage",text:"Email message",disabled:!0,iconProps:{iconName:"Mail"}},"data-automation-id","newEmailButton"),{key:"calendarEvent",text:"Calendar event",disabled:!0,iconProps:{iconName:"Calendar"}}]}},{key:"upload",text:"Upload",disabled:!0,iconProps:{iconName:"Upload"},href:"https://dev.office.com/fabric"},{key:"share",text:"Share",disabled:!0,iconProps:{iconName:"Share"},onClick:function(){return console.log("Share")}},{key:"download",text:"Download",disabled:!0,iconProps:{iconName:"Download"},onClick:function(){return console.log("Download")}}],ce=[{key:"tile",text:"Grid view",ariaLabel:"Grid view",iconOnly:!0,disabled:!0,iconProps:{iconName:"Tiles"},onClick:function(){return console.log("Tiles")}},{key:"info",text:"Info",ariaLabel:"Info",iconOnly:!0,iconProps:{iconName:"Info"},onClick:function(){return console.log("Info")}}],ie=[{disabled:!0,key:"move",text:"Move to...",onClick:function(){return console.log("Move to")},iconProps:{iconName:"MoveToFolder"}},{disabled:!0,key:"copy",text:"Copy to...",onClick:function(){return console.log("Copy to")},iconProps:{iconName:"Copy"}},{disabled:!0,key:"rename",text:"Rename...",onClick:function(){return console.log("Rename")},iconProps:{iconName:"Edit"}}];return a.a.createElement("div",null,a.a.createElement(m.Provider,{value:o},a.a.createElement(m.Consumer,null,(function(e){return a.a.createElement(a.a.Fragment,null)})),a.a.createElement(p.a,null,(function(e){switch(e.location.pathname){case"/storage":"storage"!==_&&$("storage");break;case"/edit":"edit"!==_&&$("edit");break;case"/tiles":"tiles"!==_&&$("tiles");break;case"/bars":"bars"!==_&&$("bars");break;case"/":"home"!==_&&$("home")}return a.a.createElement("div",null,a.a.createElement("div",{className:"topBar"},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",null," ",a.a.createElement("img",{src:B.a,style:{margin:"8px",marginLeft:"16px",height:"32px",width:"auto"}})),a.a.createElement("div",{style:{flexGrow:1,margin:"10px",fontSize:"24px",color:"#cccccc",whiteSpace:"nowrap",overflow:"hidden"}},"ZTICKYBAR STUDIO"),a.a.createElement("div",{style:{margin:"16px",fontSize:"12px",color:"#cccccc",whiteSpace:"nowrap",overflow:"hidden"}},f.name," (",f.userName,")"))),ne.length>0&&a.a.createElement(k.a,{messageBarType:x.a.error,isMultiline:!1,onDismiss:function(){re(ne.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(ne[0])),a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{flexGrow:1}}," ",a.a.createElement(g.a,{style:{paddingLeft:20,borderBottom:"1px solid #eeeeee"},onLinkClick:function(e){switch($(e.props.itemKey),e.props.itemKey){case"storage":Object(p.c)("/storage");break;case"home":Object(p.c)("/");break;case"edit":Object(p.c)("/edit");break;case"bars":Object(p.c)("/bars");break;case"tiles":Object(p.c)("/tiles")}},selectedKey:_},a.a.createElement(v.a,{headerText:"Dashboard",itemKey:"home"}),a.a.createElement(v.a,{headerText:"Bars",itemKey:"bars"}),a.a.createElement(v.a,{headerText:"Tiles",itemKey:"tiles"}),a.a.createElement(v.a,{headerText:"Storage",itemKey:"storage"}))),a.a.createElement("div",{style:{margin:"8px"}},a.a.createElement(O.a,{placeholder:"Select an environment",selectedKey:L.key,options:R,errorMessage:U,styles:{dropdown:{width:200},xroot:{height:100}}})))),a.a.createElement("div",null,"edit"===_&&a.a.createElement(b.a,{items:oe,farItems:ce,overflowItems:ie}),"settings"===_&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Q,null))))})),a.a.createElement("div",null),a.a.createElement(p.b,null,a.a.createElement(S,{path:"/"}),a.a.createElement(P,{path:"/storage"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[331,1,2]]]);
//# sourceMappingURL=main.be16b020.chunk.js.map