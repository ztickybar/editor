{"version":3,"sources":["services/officegraph/authHelper.js","media/BigZtransparent.png","containers/StorageAdministration/index.js","logo.svg","contexts/editor.js","pages/StoragePage/index.js","App.js","serviceWorker.js","index.js","services/officegraph/index.js"],"names":["getAccessToken","scopes","replyUrl","window","location","protocol","hostname","port","pathname","console","log","msalConfig","auth","clientId","redirectUri","authority","msalApplication","UserAgentApplication","Promise","resolve","reject","a","requestObj","handleRedirectCallback","error","response","getAccount","loginRedirect","acquireTokenSilent","authResponse","accessToken","module","exports","mergeStyles","display","marginBottom","StorageAdministrationContainer","props","useState","setAccessToken","errors","setErrors","items","setItems","isLoaded","setIsLoaded","hasExtension","setHasExtension","hasSelection","setHasSelection","needRefresh","setNeedRefresh","STORAGEKEY","selection","Selection","onSelectionChanged","selectionCount","getSelectedCount","getSelection","name","farItems","key","text","ariaLabel","iconOnly","disabled","iconProps","iconName","onClick","data","extensionName","connections","version","OfficeGraph","patch","post","push","context","AuthHelper","token","get","storages","map","item","title","value","connectionString","useEffect","load","commands","save","length","messageBarType","MessageBarType","isMultiline","onDismiss","slice","dismissButtonAriaLabel","JSON","stringify","overflowItems","columns","fieldName","minWidth","maxWidth","isResizable","setKey","layoutMode","DetailsListLayoutMode","justified","selectionPreservedOnEmptyClick","ariaLabelForSelectionColumn","ariaLabelForSelectAllCheckbox","checkButtonAriaLabel","onItemInvoked","rowNumber","e","EditorContext","React","createContext","StoragePage","StorageAdministration","HomePage","loadable","msalInstance","PTO365","user","initializeIcons","href","search","s1","split","s2","index","s3","decodeURIComponent","getSearchParametersFromHRef","App","setUser","setMe","selectedTab","setSelectedTab","then","me","catch","cacheKey","subMenuProps","Provider","Consumer","className","style","src","BigZtransparent","margin","marginLeft","height","width","flexGrow","fontSize","color","whiteSpace","overflow","userName","MessageBar","Pivot","paddingLeft","borderBottom","onLinkClick","itemKey","navigate","selectedKey","PivotItem","headerText","CommandBar","path","Boolean","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","json","require","_","request","req","body","done","action","processResult","result","plain","res","Array","isArray","toLowerCase","graph","readManager","query","sourceGroupId","params","itemId","driveId","id","newDoc","groupId","getGroupDrive","getGroupSite","readGroupMemberShipFor","matchingGroups","folder","getGroupDocuments","host","site","list","listfilter","itemfilter","getSharePointList","getGroupRootFolders","getDriveChildren","analyseMembers","userId","invite","addcrm","addmember","copyfile","err","emailAddresses","cb","addresses","forEach","element1","element2","smtp","checked","results","x","address","readUser","emailAddress","invitationRedirectUrl","first","last","tag","msg","url","headers","parsedBody","parse","post2","itemList","next","pop","readGroupMembers","upn","userPrincipalName","searchText","findGroup","folderName","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","groupNickName","fromFolder","fromName","toFolder","toName","groups","group","fromItems","find","targetFolders","destFolder","parentReference","lookupFile","iterations","file","setTimeout","config","tokenEndpoint","authorization","appendTo","retrycount","errCounter","concat","requestParams","grant_type","client_id","client_secret","clientSecret","resource","form","error_description","access_token","getRaw","hasError","payload"],"mappings":"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","file":"static/js/main.b01d39c8.chunk.js","sourcesContent":["import { UserAgentApplication } from \"msal\";\r\n\r\nfunction getAccessToken (scopes) {\r\n  var replyUrl =\r\n    window.location.protocol +\r\n    \"//\" +\r\n    window.location.hostname +\r\n    (window.location.port !== 80 &&\r\n    window.location.port !== 443 &&\r\n    window.location.port !== \"\"\r\n      ? \":\" + window.location.port\r\n      : \"\") +\r\n    window.location.pathname;\r\n  console.log(\"login replyUrl\", replyUrl);\r\n  var msalConfig = {\r\n    auth: {\r\n      clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\r\n      redirectUri: replyUrl,\r\n      authority: \"https://login.microsoftonline.com/common\"\r\n    }\r\n  };\r\n  var msalApplication = new UserAgentApplication(msalConfig);\r\n\r\n  return new Promise(async (resolve, reject) => {\r\n    var requestObj = {\r\n      scopes\r\n    };\r\n\r\n    msalApplication.handleRedirectCallback((error, response) => {\r\n      // handle redirect response or error\r\n    });\r\n\r\n    if (!msalApplication.getAccount()) {\r\n      msalApplication.loginRedirect(requestObj);\r\n    }\r\n    try {\r\n      const authResponse = await msalApplication.acquireTokenSilent(\r\n        requestObj\r\n      );\r\n      resolve(authResponse.accessToken);\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n};\r\n\r\nexport default {\r\n  getAccessToken\r\n  \r\n};","module.exports = \"data:image/png;base64,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\"","import React, { useState, useEffect } from \"react\";\n\nimport AuthHelper from \"../../services/officegraph/authHelper\";\nimport OfficeGraph from \"../../services/officegraph\";\nimport { DefaultButton } from \"office-ui-fabric-react\";\nimport { MessageBar, MessageBarType } from \"office-ui-fabric-react\";\nimport { Announced } from \"office-ui-fabric-react/lib/Announced\";\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  Selection,\n  IColumn\n} from \"office-ui-fabric-react/lib/DetailsList\";\nimport { MarqueeSelection } from \"office-ui-fabric-react/lib/MarqueeSelection\";\nimport { Fabric } from \"office-ui-fabric-react/lib/Fabric\";\nimport { mergeStyles } from \"office-ui-fabric-react/lib/Styling\";\nimport {\n    CommandBar,\n    ICommandBarItemProps\n  } from \"office-ui-fabric-react/lib/CommandBar\";\n//\nconst exampleChildClass = mergeStyles({\n  display: \"block\",\n  marginBottom: \"10px\"\n});\nfunction StorageAdministrationContainer(props) {\n  const [storages, setStorages] = useState({});\n  const [accessToken, setAccessToken] = useState(\"\");\n\n  const [errors, setErrors] = useState([]);\n  const [items, setItems] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [hasExtension, setHasExtension] = useState(false);\n  const [hasSelection, setHasSelection] = useState(false);\n  \n  const [needRefresh, setNeedRefresh] = useState(0);\n  const [selectionDetails, setSelectionDetails] = useState(null);\n\n  const STORAGEKEY = \"com.ztickybar.storage\";\n\n  const selection = new Selection({\n    onSelectionChanged: () => {\n     \n      const selectionCount = selection.getSelectedCount();\n\n      switch (selectionCount) {\n        case 0:\n            setHasSelection(false)\n          return \"No items selected\";\n       \n\n        case 1:\n          setHasSelection(true)\n          return \"1 item selected: \" + selection.getSelection()[0].name;\n        default:\n            setHasSelection(true)\n\n        return `${selectionCount} items selected`;\n\n      }\n    }\n  });\n  const columns = [\n    {\n      key: \"column1\",\n      name: \"Name\",\n      fieldName: \"name\",\n      minWidth: 100,\n      maxWidth: 200,\n      isResizable: true\n    },\n    {\n      key: \"column2\",\n      name: \"Value\",\n      fieldName: \"value\",\n      minWidth: 100,\n      maxWidth: 200,\n      isResizable: true\n    }\n  ];\n\n  var farItems = [\n    {\n      key: \"info\",\n      text: \"Info\",\n      // This needs an ariaLabel since it's icon-only\n      ariaLabel: \"Info\",\n      iconOnly: true,\n      disabled: false,\n      iconProps: { iconName: \"Info\" },\n      onClick: () => console.log(\"Info\")\n    }\n    // {\n    //   key: \"info\",\n    //   text: \"Info\",\n    //   // This needs an ariaLabel since it's icon-only\n    //   ariaLabel: \"Info\",\n    //   iconOnly: true,\n    //   iconProps: { iconName: \"Info\" },\n    //   onClick: () => console.log(\"Info\")\n    // }\n  ];\n  var overflowItems = [\n    // {\n    //   disabled: true,\n    //   key: \"move\",\n    //   text: \"Move to...\",\n    //   onClick: () => console.log(\"Move to\"),\n    //   iconProps: { iconName: \"MoveToFolder\" }\n    // },\n    // {\n    //   disabled: true,\n    //   key: \"copy\",\n    //   text: \"Copy to...\",\n    //   onClick: () => console.log(\"Copy to\"),\n    //   iconProps: { iconName: \"Copy\" }\n    // },\n    // {\n    //   disabled: true,\n    //   key: \"rename\",\n    //   text: \"Rename...\",\n    //   onClick: () => console.log(\"Rename\"),\n    //   iconProps: { iconName: \"Edit\" }\n    // }\n  ];\n  async function save() {\n    try {\n \n      var data = {\n        \"@odata.type\": \"microsoft.graph.openTypeExtension\",\n        extensionName: STORAGEKEY,\n        connections: items,\n        version:1\n      };\n      if (hasExtension){\n      var result = await OfficeGraph.patch(\n        accessToken,\n        `https://graph.microsoft.com/v1.0/me/extensions/${STORAGEKEY}`,\n        data\n      );\n    }else{\n        var result = await OfficeGraph.post(\n            accessToken,\n            \"https://graph.microsoft.com/v1.0/me/extensions/\",\n            data)\n            setHasExtension(true)\n    }\n    } catch (error) {\n      errors.push({\n        context: \" OfficeGraph.auth.getAccessToken()\",\n        error\n      });\n      setErrors(errors);\n      setNeedRefresh(needRefresh + 1);\n    }\n  }\n  async function load() {\n    try {\nif (isLoaded) return\n      var token = await AuthHelper.getAccessToken([\"User.Read.All\"]);\n      setAccessToken(token);\n      var storages = await OfficeGraph.get(\n        token,\n        `https://graph.microsoft.com/v1.0/me/extensions/${STORAGEKEY}`\n      );\n    \n      switch (storages.version) {\n          case 1:\n              setItems(storages.connections)\n              break;\n      \n          default:\n              var items = storages.connections.map(item=>{\n                  return {name:item.title,value:item.connectionString}\n              })\n              setItems(items)\n              break;\n      }\n     \n      setIsLoaded(true)\n      setHasExtension(true)\n    } catch (error) {\n      errors.push({\n        context: \" OfficeGraph.auth.getAccessToken()\",\n        error\n      });\n      setErrors(errors);\n      setNeedRefresh(needRefresh + 1);\n\n    }\n  }\n  useEffect(() => {\n    load();\n  }, [needRefresh,hasSelection]);\n  var commands = [\n    {\n        key: \"save\",\n        text: \"Save\",\n        disabled: false,\n        iconProps: { iconName: \"Save\" },\n        onClick: () => {\n            save();\n        }}\n      ,\n    {\n      key: \"add\",\n      text: \"Add\",\n      disabled: false,\n      iconProps: { iconName: \"AddLink\" },\n      onClick: () => {\n        items.push({ name: \"Name\", value: \"Value\" });\n        setItems(items);\n        setNeedRefresh(needRefresh + 1);\n      }}\n    ,\n    {\n      key: \"delete\",\n      text: \"Delete\",\n      disabled: !hasSelection ,\n      iconProps: { iconName: \"RemoveLink\" },\n      onClick: () => console.log(\"Deleting\")\n    },\n    {\n      key: \"verify\",\n      text: \"Verify\",\n      disabled: !hasSelection,\n      iconProps: { iconName: \"AccessibiltyChecker\" },\n      onClick: () => console.log(\"Verifying\")\n    }\n  ];\n  return (\n    <div>\n      {errors.length > 0 && (\n        <MessageBar\n          messageBarType={MessageBarType.error}\n          isMultiline={true}\n          onDismiss={() => {\n            setErrors(errors.slice(1));\n          }}\n          dismissButtonAriaLabel=\"Close\"\n        >\n          Error: {JSON.stringify(errors[0])}\n        </MessageBar>\n      )}\n      <CommandBar\n                      items={commands}\n                      farItems={farItems}\n                      overflowItems={overflowItems}\n                    />\n      <DetailsList\n        items={items}\n        columns={columns}\n        setKey=\"set\"\n        layoutMode={DetailsListLayoutMode.justified}\n        selection={selection}\n        selectionPreservedOnEmptyClick={true}\n        ariaLabelForSelectionColumn=\"Toggle selection\"\n        ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n        checkButtonAriaLabel=\"Row checkbox\"\n        onItemInvoked={(item, rowNumber, e) => {\n          console.log(\"Invoked\",item,rowNumber)\n        }}\n      />\n     \n    </div>\n  );\n}\n\nexport default StorageAdministrationContainer;\n","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","\nimport React from \"react\";\n\nexport const EditorContext = React.createContext({ });\n\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport StorageAdministrationContainer from '../../containers/StorageAdministration'\n\nexport default function StoragePage() {\n  return (\n    <>\n    <StorageAdministrationContainer />\n    </>\n  );\n}\n\nStoragePage.propTypes = {\n\n}\n","import React, { useState, useEffect,useReducer } from \"react\";\nimport loadable from \"@loadable/component\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\nimport { EditorContext } from \"./contexts/editor\";\nimport { Router, Match, Location, navigate } from \"@reach/router\";\n\nimport { UserAgentApplication } from \"msal\";\nimport { Label, ILabelStyles } from \"office-ui-fabric-react/lib/Label\";\nimport { Pivot, PivotItem } from \"office-ui-fabric-react/lib/Pivot\";\nimport {\n  CommandBar,\n  ICommandBarItemProps\n} from \"office-ui-fabric-react/lib/CommandBar\";\nimport { initializeIcons } from \"@uifabric/icons\";\nimport BigZtransparent from \"./media/BigZtransparent.png\";\nimport AuthHelper from \"./services/officegraph/authHelper\";\nimport OfficeGraph from \"./services/officegraph\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps\n} from \"office-ui-fabric-react\";\n\n//\nimport StoragePage from \"./pages/StoragePage\";\n\nconst HomePage = loadable(() => import(\"./pages/HomePage\"));\nconst StorageAdministrationContainer = loadable(() =>\n  import(\"./containers/StorageAdministration\")\n);\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\nfunction auth() {\n  return new Promise((resolve, reject) => {\n    try {\n      var replyUrl =\n        window.location.protocol +\n        \"//\" +\n        window.location.hostname +\n        (window.location.port !== 80 &&\n        window.location.port !== 443 &&\n        window.location.port !== \"\"\n          ? \":\" + window.location.port\n          : \"\") +\n        window.location.pathname;\n\n      var msalConfig = {\n        auth: {\n          clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n          redirectUri: replyUrl\n        }\n      };\n      var requestObj = {\n        scopes: [\"user.read\"]\n      };\n      var msalInstance = new UserAgentApplication(msalConfig);\n      msalInstance.handleRedirectCallback((error, response) => {\n        // handle redirect response or error\n      });\n      var PTO365 = {\n        user: msalInstance.getAccount()\n      };\n      if (!PTO365.user) {\n        msalInstance.loginRedirect(requestObj);\n      }\n\n      resolve(PTO365.user);\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n/**********************************************************************************************************\n * BOOT\n **********************************************************************************************************/\n\ninitializeIcons();\nconst search = getSearchParametersFromHRef(window.location.href);\n\n\n\n\n\n\nfunction App(props) {\n  const [context, setContext] = useState({});\n  const [user, setUser] = useState({});\n  const [me, setMe] = useState({});\n  const [accessToken, setAccessToken] = useState(\"\");\n\n  //TODO: Set selectedTab on load depend on route\n  const [selectedTab, setSelectedTab] = useState(\"home\");\n  const [errors, setErrors] = useState([]);\n  // https://www.robinwieruch.de/react-hooks-fetch-data\n\n  async function load() {\n    auth()\n      .then(async user => {\n        setUser(user);\n        if (me) return\n        try {\n          var token = await AuthHelper.getAccessToken([\"User.Read.All\"]);\n          setAccessToken(token);\n          var me = await OfficeGraph.get(\n            token,\n            \"https://graph.microsoft.com/v1.0/me\"\n          );\n          setMe(me)\n        } catch (error) {\n          errors.push({\n            context: \" OfficeGraph.auth.getAccessToken()\",\n            error\n          });\n          setErrors(errors);\n        }\n\n        // OfficeGraph.me().then(me=>{\n        //   debugger\n        // })\n        // .catch(error => {\n        //   errors.push({ context: \" OfficeGraph.me() \", error });\n        //   setErrors(errors);\n        // });\n      })\n      .catch(error => {\n        errors.push({ context: \"useEffect().auth() \", error });\n        setErrors(errors);\n      });\n  }\n  useEffect(() => {\n    \n    load();\n  }, []);\n  var items = [\n    {\n      key: \"newItem\",\n      text: \"New\",\n      cacheKey: \"myCacheKey\", // changing this key will invalidate this item's cache\n      iconProps: { iconName: \"Add\" },\n      subMenuProps: {\n        items: [\n          {\n            key: \"emailMessage\",\n            text: \"Email message\",\n            disabled: true,\n            iconProps: { iconName: \"Mail\" },\n            [\"data-automation-id\"]: \"newEmailButton\" // optional\n          },\n          {\n            key: \"calendarEvent\",\n            text: \"Calendar event\",\n            disabled: true,\n            iconProps: { iconName: \"Calendar\" }\n          }\n        ]\n      }\n    },\n    {\n      key: \"upload\",\n      text: \"Upload\",\n      disabled: true,\n      iconProps: { iconName: \"Upload\" },\n      href: \"https://dev.office.com/fabric\"\n    },\n    {\n      key: \"share\",\n      text: \"Share\",\n      disabled: true,\n      iconProps: { iconName: \"Share\" },\n      onClick: () => console.log(\"Share\")\n    },\n    {\n      key: \"download\",\n      text: \"Download\",\n      disabled: true,\n      iconProps: { iconName: \"Download\" },\n      onClick: () => console.log(\"Download\")\n    }\n  ];\n  var farItems = [\n    {\n      key: \"tile\",\n      text: \"Grid view\",\n      // This needs an ariaLabel since it's icon-only\n      ariaLabel: \"Grid view\",\n      iconOnly: true,\n      disabled: true,\n      iconProps: { iconName: \"Tiles\" },\n      onClick: () => console.log(\"Tiles\")\n    },\n    {\n      key: \"info\",\n      text: \"Info\",\n      // This needs an ariaLabel since it's icon-only\n      ariaLabel: \"Info\",\n      iconOnly: true,\n      iconProps: { iconName: \"Info\" },\n      onClick: () => console.log(\"Info\")\n    }\n  ];\n  var overflowItems = [\n    {\n      disabled: true,\n      key: \"move\",\n      text: \"Move to...\",\n      onClick: () => console.log(\"Move to\"),\n      iconProps: { iconName: \"MoveToFolder\" }\n    },\n    {\n      disabled: true,\n      key: \"copy\",\n      text: \"Copy to...\",\n      onClick: () => console.log(\"Copy to\"),\n      iconProps: { iconName: \"Copy\" }\n    },\n    {\n      disabled: true,\n      key: \"rename\",\n      text: \"Rename...\",\n      onClick: () => console.log(\"Rename\"),\n      iconProps: { iconName: \"Edit\" }\n    }\n  ];\n  return (\n    <div>\n      <EditorContext.Provider value={context}>\n        <EditorContext.Consumer>\n          {props => {\n            return <></>;\n          }}\n        </EditorContext.Consumer>\n        <Location>\n          {({ location }) => {\n            switch (location.pathname) {\n              case \"/storage\":\n                if (selectedTab !== \"storage\") setSelectedTab(\"storage\");\n                break;\n\n              case \"/edit\":\n                if (selectedTab !== \"edit\") setSelectedTab(\"edit\");\n                break;\n              case \"/tiles\":\n                if (selectedTab !== \"tiles\") setSelectedTab(\"tiles\");\n                break;\n              case \"/bars\":\n                if (selectedTab !== \"bars\") setSelectedTab(\"bars\");\n                break;\n              case \"/\":\n                if (selectedTab !== \"home\") setSelectedTab(\"home\");\n                break;\n\n              default:\n                break;\n            }\n            // ...\n            return (\n              <div>\n                <div className=\"topBar\">\n                  <div style={{ display: \"flex\" }}>\n                    <div>\n                      {\" \"}\n                      <img\n                        src={BigZtransparent}\n                        style={{\n                          margin: \"8px\",\n                          marginLeft: \"16px\",\n                          height: \"32px\",\n                          width: \"auto\"\n                        }}\n                      ></img>\n                    </div>\n                    <div\n                      style={{\n                        flexGrow: 1,\n                        margin: \"10px\",\n                        fontSize: \"24px\",\n                        color: \"#cccccc\",\n                        whiteSpace: \"nowrap\",\n                        overflow: \"hidden\"\n                      }}\n                    >\n                      ZTICKYBAR STUDIO\n                    </div>\n                    <div\n                      style={{\n                        margin: \"16px\",\n                        fontSize: \"12px\",\n                        color: \"#cccccc\",\n                        whiteSpace: \"nowrap\",\n                        overflow: \"hidden\"\n                      }}\n                    >\n                      {user.name} ({user.userName})\n                    </div>\n                  </div>\n                </div>\n\n                {errors.length > 0 && (\n                  <MessageBar\n                    messageBarType={MessageBarType.error}\n                    isMultiline={false}\n                    onDismiss={() => {\n                      setErrors(errors.slice(1));\n                    }}\n                    dismissButtonAriaLabel=\"Close\"\n                  >\n                    Error: {JSON.stringify(errors[0])}\n                  </MessageBar>\n                )}\n                <div>\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ flexGrow: 1 }}>\n                      {\" \"}\n                      <Pivot\n                        style={{ paddingLeft: 20, borderBottom:\"1px solid #eeeeee\"}}\n                        onLinkClick={item => {\n                          setSelectedTab(item.props.itemKey);\n                          switch (item.props.itemKey) {\n                            case \"storage\":\n                              navigate(\"/storage\");\n                              break;\n                            case \"home\":\n                              navigate(\"/\");\n                              break;\n                            case \"edit\":\n                              navigate(\"/edit\");\n                              break;\n                            case \"bars\":\n                              navigate(\"/bars\");\n                              break;\n                            case \"tiles\":\n                              navigate(\"/tiles\");\n                              break;\n                            default:\n                              break;\n                          }\n                        }}\n                        selectedKey={selectedTab}\n                      >\n                        <PivotItem headerText=\"Dashboard\" itemKey=\"home\" />\n                        <PivotItem headerText=\"Bars\" itemKey=\"bars\" />\n                        <PivotItem headerText=\"Tiles\" itemKey=\"tiles\" />\n                        \n                        <PivotItem headerText=\"Storage\" itemKey=\"storage\" />\n                      </Pivot>\n                    </div>\n                    <div>ACTIONS</div>\n                  </div>\n                </div>\n                <div>\n                  {selectedTab === \"edit\" && (\n                    <CommandBar\n                      items={items}\n                      farItems={farItems}\n                      overflowItems={overflowItems}\n                    />\n                  )}\n                  {selectedTab === \"settings\" && (\n                    <>\n                      <StorageAdministrationContainer />\n                    </>\n                  )}\n                </div>\n              </div>\n            );\n          }}\n        </Location>\n        <div>\n\n\n        </div>\n        <Router>\n          <HomePage path=\"/\" />\n          <StoragePage path=\"/storage\" />\n        </Router>\n      </EditorContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","var json = require(\"format-json\")\nvar _ = require(\"lodash\")\nvar request = require('request');\n\n//var Q = require('q');\nmodule.exports = function (context, req) {\n  var data = req.body\n  if (!data) return context.done(\"Missing a request body\")\n  if (!data.action) return context.done(\"Missing a body.action parameter\")\n\n\n  auth.getAccessToken().then(function (token) {\n\n      var key = data.action.toLowerCase()\n\n      switch (key) {\n        case 'manager':\n          graph.readManager(token, data.query, 0, processResult)\n          break;\n        case 'newdoc':\n          var params = data.query.split(\"|\")\n\n          var sourceGroupId = params.length > 0 ? params[0] : ''\n          var itemId = params.length > 1 ? params[1] : '/'\n          var driveId = params.length > 1 ? params[2] : '/'\n          var id = params.length > 1 ? params[3] : '/'\n          var name = params.length > 1 ? params[4] : '/'\n          graph.newDoc(token, sourceGroupId, itemId, driveId, id, name, processResult)\n          break;\n        case 'getgroupdrive':\n          var params = data.query.split(\"|\")\n\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupDrive(token, groupId, processResult)\n          break;\n        case 'getgroupsite':\n          var params = data.query.split(\"|\")\n\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupSite(token, groupId, processResult)\n          break;\n        case 'memberof':\n          graph.readGroupMemberShipFor(token, data.query, processResult)\n          break;\n        case 'matchinggroups':\n          graph.matchingGroups(token, data.query, processResult)\n          break;\n        case 'getgroupdocs':\n          var params = data.query.split(\"|\")\n          var groupId = params.length > 0 ? params[0] : ''\n          var folder = params.length > 1 ? params[1] : '/'\n          graph.getGroupDocuments(token, groupId, folder, processResult)\n          break;\n        case 'sharepointlist':\n          var params = data.query.split(\"|\")\n          var host = params.length > 0 ? params[0] : ''\n          var site = params.length > 1 ? params[1] : ''\n          var list = params.length > 2 ? params[2] : ''\n          var listfilter = params.length > 3 ? params[3] : ''\n          var itemfilter = params.length > 4 ? params[4] : ''\n          graph.getSharePointList(token, host, site, list, listfilter, itemfilter, processResult)\n          break;          \n        case 'getgrouprootfolders':\n          var params = data.query.split(\"|\")\n          var groupId = params.length > 0 ? params[0] : ''\n          graph.getGroupRootFolders(token, groupId,  processResult)\n          break;\n        case 'getdrivechildren':\n          var params =  data.query.split(\"|\")\n          var driveId = params.length > 0 ? params[0] : ''\n          var itemId = params.length > 1 ? params[1] : ''\n          graph.getDriveChildren(token, driveId, itemId, processResult)\n          break;\n        case 'collaboratewith':\n          graph.analyseMembers(token, data.query, processResult)\n\n          break;\n        case 'invite':\n        var params = data.query.split(\"|\")\n        var userId = params[0]\n        var groupId = params[1]\n          graph.invite(token, userId,\"https://teams.microsoft.com/l/team/19%3a0e28628caa7745af8d1be8b1291d3fe8%40thread.skype/conversations?groupId=b4cc43ed-537d-4111-907d-a8eb4dabd7e8&tenantId=df96b8c9-51a1-40cf-b8b1-4514be8e9668\", processResult)\n\n          break;  \n        case 'addcrm':\n\n          var params = data.query.split(\"|\")\n\n\n          graph.addcrm(token, params[0],params[1],params[2],params[3], processResult)\n\n          break;  \n        case 'addmember':\n          var params = data.query.split(\"|\")\n          var userId = params[0]\n          var groupId = params[1]\n          graph.addmember(token, userId,groupId,  processResult)\n          break;  \n        case 'copyfile':\n          var params = data.query.split(\"|\")\n\n          if (params.length < 5 ){\n            processResult(\"Wrong number of parameters \")\n          }else{\n          \n            graph.copyfile(token, params[0],params[1],params[2],params[3],params[4], processResult)\n          }\n          break;\n\n        default:\n          processResult(\"Unsupported \" + key)\n\n          break;\n      }\n\n    },\n    (err) => {\n      console.log(err)\n    })\n\n\n  function processResult(error, result) {\n    if (error) {\n      context.log(json.plain(error))\n      context.res = {\n        error: error\n      };\n\n      return context.done()\n    }\n    context.log(json.plain(result))\n\n    context.res = {\n      data: Array.isArray(result) ? result : [result] // always return an array\n    };\n    return context.done()\n\n  }\n};\n\nvar graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n\n\n  var addresses = []\n\n  var ar1 = emailAddresses.split(\"\\n\")\n  ar1.forEach(element1 => {\n    var ar2 = element1.split(\";\")\n    ar2.forEach(element2 => {\n\n      var smptAddresses = extractEmails(element2)\n      smptAddresses.forEach(smtp => {\n        addresses.push({\n          checked: false,\n          smtp\n        })\n      })\n\n    })\n  });\n\n  var results = []\n  var x = addresses.length\n  addresses.forEach(address => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--\n      address.user = user\n      address.err = err\n      results.push(address)\n      if (x < 1) {\n        cb(null, results)\n        address.checked = true\n      }\n    })\n  })\n\n\n\n\n}\ngraph.invite = (token, emailAddress,invitationRedirectUrl, cb) => {\n\n\n  var msg = \n  {\n    \"invitedUserEmailAddress\": emailAddress,\n    \"inviteRedirectUrl\": invitationRedirectUrl,\n    \"invitedUserDisplayName\": emailAddress,\n    \"sendInvitationMessage\": false,\n        \"invitedUserMessageInfo\": {\n            \"customizedMessageBody\": \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n            \"ccRecipients\": [\n              {\n                \"emailAddress\": {\n                  \"name\": \"Niels\",\n                  \"address\": \"niels@jumpto365.com\"\n                }\n              }\n            ]\n        }\n}\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, \n  function (err ,response) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null,response)\n    \n  })\n\n\n\n}\ngraph.addcrm = (token, emailAddress,first,last,tag, cb) => {\n\n\n  var msg = \n  {\n    \"properties\": [\n      {\n        \"property\": \"firstname\",\n        \"value\": first\n      },\n      {\n        \"property\": \"lastname\",\n        \"value\": last\n      },\n      {\n        \"property\": \"internal_categories\",\n        \"value\": tag\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ]\n  }\n\n   \n  post2(token, `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`, msg, \n  function (err ,response) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null,response)\n    \n  })\n\n\n\n}\ngraph.addmember = (token, userId,groupId, cb) => {\n\n\n  var msg = \n  {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`\n  }\n  post(token, `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`, msg, \n  function (err,response ) {\n    \n    if (err){\n      return cb(err)\n    }\n    cb(null)\n    \n  })\n\n\n\n}\n\ngraph.getSharePointList = (token, host, site, list, listfilter, itemfilter, cb) => {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`, function (e, items) {\n  if (e) return cb(e)\n    var itemList = []\n\n    function next() {\n      if (items.length === 0) return cb(null, itemList)\n      var item = items.pop()\n      \n      get(token, `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`, function (e, item) {\n        if (e) return cb(e)\n        itemList.push(item)\n        next()\n      })\n    }\n\n    next()\n\n  })\n}\n\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(token, 'https://graph.microsoft.com/beta/groups/' + groupId + '/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id', cb)\n};\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + upn + '/memberOf', cb)\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + userPrincipalName + '/manager', cb, null, index)\n}\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(token, 'https://graph.microsoft.com/v1.0/users/' + userPrincipalName, cb, null, index)\n}\n\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`, cb)\n}\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`, cb)\n}\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`, cb)\n}\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb)\n}\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`, cb)\n}\n\ngraph.getDriveChildren = function (token, driveId,itemId, cb) {\n  get(token, `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`, cb)\n}\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`, cb)\n}\n\ngraph.getSharePointSiteByName = function (token, hostName,relativePath, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`, cb)\n}\n\ngraph.getSharePointSiteDrive = function (token, id,path, cb) {\n  get(token, `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`, cb)\n}\n\n\ngraph.copyfile = function(token,groupNickName,fromFolder,fromName, toFolder,toName,cb){\n\ngraph.findGroup(token,groupNickName,function (err,groups){\n    if (err) return cb(err)\n    if (groups.length!==1) return cb(\"Did't find a unique group\")\n    var group = groups[0]\n    graph.getGroupDocuments(token,group.id,\"/\" + fromFolder,function (err,fromItems){\n      if (err) return cb(err)\n      var match = _.find(fromItems,{\"name\":fromName})\n      graph.getGroupRootFolders(token,group.id,function (err,targetFolders){\n        if (err) return cb(err)\n        var destFolder = _.find(targetFolders,{\"name\":toFolder})\n        if (!destFolder) return cb(\"Did't find target folder\")\n        graph.newDoc(token,group.id,match.id,destFolder.parentReference.driveId,  destFolder.id,toName,function (err,result){\n          if (err) return cb(err)\n          return cb(null,result)\n        })\n      })\n     })\n       \n    })\n\n\n}\n\n\nfunction lookupFile(token,driveId,id,name,iterations,cb){\n    // Content have been copied \n    graph.getDriveChildren(token,driveId,id,function (err,result){\n      if (err){\n        return cb(err)\n      }\n      // content of destination folder \n\n\n    for (let index = 0; index < result.length; index++) {\n\n      const file = result[index];\n\n      console.log(\"Comparing\",file.name,name)\n      if (file.name === name){\n        // match found  \n        console.log(\"Match found\")\n        return cb(null,file)\n      }\n    }\n\n        \n    function retry(){\n      console.log(\"Retrying\",iterations)\n      //\n      if (iterations > 10){\n        return (cb(`Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `))\n      }\n      lookupFile(token,driveId,id,name,iterations+1,cb)\n      \n\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000)\n      \n    \n    })\n  }\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n\n\n  post(token, `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`, {\n    \"parentReference\": {\n      \"driveId\": driveId,\n      \"id\": id\n    },\n    \"name\": name\n  }, function (err){ // no result from that call - by design from Microsoft\n    if (err){\n      return cb(err)\n    }\n\n    // so we fill try to find a referece our self\n    lookupFile(token,driveId,id,name,0,cb)\n  })\n\n\n}\n\n\n\n\n\n\n\n\n\n\nvar auth = {};\n\n\nvar config = {\n  \n  \n  tokenEndpoint: 'https://login.microsoftonline.com/common/oauth2/token',\n};\n\n\n\nauth.getAccessToken = function () {\n  if (window){\n    throw(\"Not valid client side\")\n  }\n  return new Promise((resolve, reject) => {\n\n    var requestParams = {\n      grant_type: 'client_credentials',\n      client_id: config.clientId,\n      client_secret: config.clientSecret,\n      resource: 'https://graph.microsoft.com'\n    };\n\n    request.post({\n      url: config.tokenEndpoint,\n      form: requestParams\n    }, function (err, response, body) {\n      var parsedBody = JSON.parse(body);\n\n      if (err) {\n\n        reject(err);\n      } else if (parsedBody.error) {\n        reject(parsedBody.error_description);\n      } else {\n        resolve(parsedBody.access_token);\n      }\n    });\n  })\n};\n\nfunction post2(token, url, body, cb) {\n  request.post({\n    url: url,\n    headers: {\n      'content-type': 'application/json'\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\n\nfunction post(token, url, body, cb) {\n  request.post({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\nfunction patch(token, url, body, cb) {\n  request.patch({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    },\n    body: JSON.stringify(body)\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      return cb(err);\n    } else {\n\n      parsedBody = body === \"\" ? {} : JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(\n          parsedBody.error\n        );\n      } else {\n        cb(null, parsedBody);\n      }\n    }\n  });\n\n}\n\nfunction get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true)\n  request.get({\n    url: url,\n    headers: {\n      'content-type': 'application/json',\n      authorization: 'Bearer ' + token\n    }\n  }, function (err, response, body) {\n    var parsedBody;\n\n    if (err) {\n      var errCounter = retrycount ? retrycount + 1 : 1;\n      if (errCounter > 3) {\n        return cb(err, null, index);\n      } else {\n        // retry \n        console.log(\"retry #\", errCounter)\n        return get(token, url, cb, appendTo, index, errCounter)\n      }\n    }\n\n    parsedBody = JSON.parse(body);\n    if (parsedBody.error) {\n      return cb(\n        parsedBody.error, null, index\n      );\n    }\n\n    if (parsedBody['@odata.nextLink']) {\n      var data;\n      if (!appendTo) {\n        data = parsedBody.value\n      } else {\n        data = appendTo.concat(parsedBody.value)\n      }\n\n      return get(token, parsedBody['@odata.nextLink'], cb, data, index)\n    }\n\n    if (appendTo) {\n      cb(null, appendTo.concat(parsedBody.value), index)\n    } else {\n      if (parsedBody.value) {\n        cb(null, parsedBody.value, index);\n      } else {\n        cb(null, parsedBody, index);\n      }\n    };\n  });\n};\n\nmodule.exports.getRaw = (token, url) => {\n  console.log(\"getting\", url)\n\n  return new Promise((resolve, reject) => {\n    \n  \n  request.get({\n    url: url,\n    headers: {\n      authorization: 'Bearer ' + token\n    }\n  }, function (err, response, body) {\n   \n\n    if (err) {\n        return resolve({hasError:true,error:err})\n    }\n    resolve({hasError:false,result:body})\n    \n  });\n});\n};\n\n\nmodule.exports.get = (token,url) => {\n  return new Promise((resolve, reject) => {\n    get(token,url,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.post = (token,url,payload) => {\n  return new Promise((resolve, reject) => {\n    post(token,url,payload,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.patch = (token,url,payload) => {\n  return new Promise((resolve, reject) => {\n    patch(token,url,payload,(error,result)=>{\n      \n      if (error) return reject(error)\n      resolve(result)})  \n  });\n  \n\n}\nmodule.exports.graph = graph\nmodule.exports.auth = auth\n"],"sourceRoot":""}